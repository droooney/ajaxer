{"version":3,"file":"ajaxer.min.js","sources":["../lib/utils.js","../lib/constructURL.js","../lib/Ajaxer.js","../lib/global.js","../lib/Promise.js","../lib/parseHeaders.js","../lib/transformData.js","../browser.js"],"sourcesContent":["const {\n  hasOwnProperty,\n  toString\n} = {};\nconst whiteSpace = /^\\s*|\\s*$/g;\nconst primitive = /^(number|string|boolean|symbol|undefined)$/;\n\nexport function toStringTag(value) {\n  return toString\n    .call(value)\n    .slice(8, -1);\n}\n\nexport const isArray = Array.isArray || ((value) => (\n  toStringTag(value) === 'Array'\n));\n\nexport function isFunction(value) {\n  return typeof value === 'function' || toStringTag(value) === 'Function';\n}\n\nexport function isObject(value) {\n  return typeof value && (typeof value === 'object' || isFunction(value));\n}\n\nexport function isPrimitive(value) {\n  return value === null || /^(number|string|boolean|symbol|undefined)$/.test(typeof value);\n}\n\nexport function isString(value) {\n  return toStringTag(value) === 'String';\n}\n\nexport function assign(target, ...objects) {\n  iterate(objects, (source) => {\n    iterate(source, (value, key) => {\n      target[key] = value;\n    });\n  });\n\n  return target;\n}\n\nexport function iterate(object, callback) {\n  const array = isArray(object);\n\n  let iterated = 0;\n  const { length } = object || {};\n\n  for (const key in object) {\n    if (hasOwnProperty.call(object, key)) {\n      if (array && iterated++ >= length) {\n        break;\n      }\n\n      callback(object[key], array ? +key : key, object);\n    }\n  }\n}\n\nexport function map(object, callback) {\n  const newObject = isArray(object)\n    ? []\n    : {};\n\n  iterate(object, (value, key) => {\n    newObject[key] = callback(value, key, object);\n  });\n\n  return newObject;\n}\n\nexport function trim(string) {\n  return string.replace(whiteSpace, '');\n}\n\nexport function replaceString(string, stringToReplace, replacement) {\n  return string\n    .split(stringToReplace)\n    .join(replacement);\n}\n\nexport function deepClone(object) {\n  if (isPrimitive(object) || isFunction(object)) {\n    return object;\n  }\n\n  const clone = isArray(object)\n    ? []\n    : {};\n\n  iterate(object, (value, key) => {\n    clone[key] = deepClone(value);\n  });\n\n  return clone;\n}\n\nexport function deepAssign(target, ...objects) {\n  iterate(objects, (object) => {\n    iterate(object, (object, key) => {\n      if (isPrimitive(object) || !hasOwnProperty.call(target, key)) {\n        target[key] = deepClone(object);\n\n        return;\n      }\n\n      if (!isPrimitive(target[key])) {\n        deepAssign(target[key], object);\n      }\n    });\n  });\n\n  return target;\n}\n\nexport function hasOwn(object, property) {\n  return hasOwnProperty.call(object, property);\n}\n","import {\n  isArray,\n  isObject,\n  iterate,\n  map,\n  replaceString\n} from './utils';\n\nconst absoluteURLRegexp = /^(([a-z][a-z\\d+\\-.]*:)?\\/\\/|data:[a-z]+\\/[a-z]+;base64,)/i;\nconst emptyArray = [];\n\nexport default (baseURL, url, params, query) => {\n  let URL = isAbsolute(url)\n    ? url\n    : `${ String(baseURL).replace(/\\/+$/, '') }/${ String(url).replace(/^\\/+/, '') }`;\n\n  iterate(params, (value, param) => {\n    URL = replaceString(URL, `:${ param }`, encode(value));\n  });\n\n  const queryParams = querySwitcher(query, '');\n\n  if (queryParams.length) {\n    const prefix = URL.indexOf('?') === -1 ? '?' : '&';\n    const postfix = map(queryParams, ({ param, value }) => (\n      `${ encode(param) }=${ encode(value) }`\n    )).join('&');\n\n    URL += prefix + postfix;\n  }\n\n  return URL;\n};\n\nfunction isAbsolute(url) {\n  return absoluteURLRegexp.test(url);\n}\n\nfunction encode(string) {\n  return encodeURIComponent(string);\n}\n\nfunction querySwitcher(query, prefix) {\n  /* eslint indent: 0 */\n  switch (true) {\n    case isArray(query): {\n      const queryParams = [];\n\n      iterate(query, (value) => {\n        if (isObject(value)) {\n          return queryParams.push(...querySwitcher(value, `${ prefix }[]`));\n        }\n\n        queryParams.push({\n          param: `${ prefix }[]`,\n          value\n        });\n      });\n\n      return queryParams;\n    }\n\n    case isObject(query): {\n      const queryParams = [];\n\n      iterate(query, (value, param) => {\n        if (isObject(value)) {\n          queryParams.push(...querySwitcher(value, prefix ? `${ prefix }[${ param }]` : param));\n\n          return;\n        }\n\n        queryParams.push({\n          param: prefix ? `${ prefix }[${ param }]` : param,\n          value: String(value)\n        });\n      });\n\n      return queryParams;\n    }\n\n    default: {\n      return emptyArray;\n    }\n  }\n}\n","import {\n  isFunction,\n  isString,\n  assign,\n  iterate,\n  deepAssign,\n  deepClone,\n  hasOwn\n} from './utils';\n\nimport Promise from './Promise';\n\nimport constructURL from './constructURL';\nimport parseHeaders from './parseHeaders';\nimport transformData from './transformData';\n\n/**\n * @typedef {'get'|'post'|'delete'|'head'|'put'|'patch'} AjaxerMethod\n * @public\n */\n\n/**\n * @typedef {Object} AjaxerConfig\n * @public\n * @property {Array.<AjaxerAfterMiddleware|AjaxerErrorAfterMiddleware>} [after]\n * @property {Object} [auth]\n * @property {String} [auth.username]\n * @property {String} [auth.password]\n * @property {String} [baseURL]\n * @property {Array.<AjaxerBeforeMiddleware|AjaxerErrorBeforeMiddleware>} [before]\n * @property {*} [data]\n * @property {Object.<String, String>} [headers]\n * @property {AjaxerMethod} [method]\n * @property {Object} [params]\n * @property {Object} [query]\n * @property {String} [responseType]\n * @property {Number} [timeout]\n * @property {String} [url]\n * @property {Boolean} [withCredentials]\n */\n\n/**\n * @typedef {Object} AjaxerResponse\n * @public\n * @property {AjaxerConfig} config\n * @property {*} data\n * @property {Object.<String, String>} headers\n * @property {Number} status\n * @property {String} statusText\n * @property {XMLHttpRequest} xhr\n */\n\n/**\n * @callback AjaxerAfterMiddleware\n * @public\n * @param {AjaxerResponse} config - Ajaxer response.\n */\n\n/**\n * @callback AjaxerErrorAfterMiddleware\n * @public\n * @param {Error|*} err - Thrown error.\n * @param {AjaxerResponse} config - Ajaxer response.\n */\n\n/**\n * @callback AjaxerBeforeMiddleware\n * @public\n * @param {AjaxerConfig} config - Ajaxer config.\n */\n\n/**\n * @callback AjaxerErrorBeforeMiddleware\n * @public\n * @param {Error|*} err - Thrown error.\n * @param {AjaxerConfig} config - Ajaxer config.\n */\n\n/**\n * @callback AjaxerConfigFunction\n * @public\n * @param {AjaxerConfig} config\n */\n\nconst defaults = {\n  after: [],\n  auth: {\n    username: '',\n    password: ''\n  },\n  baseURL: global.location.origin,\n  before: [],\n  data: null,\n  headers: {},\n  method: 'get',\n  params: {},\n  query: {},\n  responseType: '',\n  timeout: 0,\n  url: '',\n  withCredentials: false\n};\nconst uploadMethods = ['POST', 'PUT'];\n\n/**\n * @class Ajaxer\n * @extends Function\n * @public\n * @param {AjaxerConfig} [config = {}] - Config to add.\n * @returns {Ajaxer} Instance of Ajaxer.\n * An instance of Ajaxer is a function that simply calls #request with the same arguments.\n * @description Class for fetching data.\n *\n * @example\n * const ajaxer = new Ajaxer();\n *\n * ajaxer('/data').then((res) => {\n *   console.log(res);\n * });\n */\nclass Ajaxer extends Function {\n  constructor(config = {}) {\n    super();\n\n    function ajaxer() {\n      return ajaxer.request.apply(ajaxer, arguments);\n    }\n\n    const conf = deepAssign({}, defaults, config);\n\n    if (conf.before.indexOf(fetchBeforeMiddleware) === -1) {\n      conf.before.push(fetchBeforeMiddleware);\n    }\n\n    /**\n     * @member {AjaxerConfig} Ajaxer#$$\n     * @type {AjaxerConfig}\n     * @public\n     * @description Ajaxer config.\n     */\n    Object.defineProperty(ajaxer, '$$', { value: conf });\n    Object.setPrototypeOf(ajaxer, Ajaxer.prototype);\n\n    return ajaxer;\n  }\n\n  /**\n   * @method Ajaxer#after\n   * @public\n   * @param {AjaxerAfterMiddleware|AjaxerErrorAfterMiddleware} middleware - Middleware to add.\n   * @param {Boolean|*} [afterAll = true] - Boolean parameter where to put the middleware.\n   * Truthy parameter stands for \"to the end\" and falsey for \"to the beginning\".\n   * @returns {Ajaxer} Returns this.\n   * @description Middleware that is called after the request.\n   * If the middleware has 2 or less arguments it's treated as success middleware otherwise as an error one.\n   * If the middleware returns a promise it becomes a part of the middleware chain.\n   *\n   * @example\n   * const ajaxer = new Ajaxer()\n   *   .after((err, res) => {\n   *     console.log(err);\n   *\n   *     throw err;\n   *   })\n   *   .after((res) => {\n   *     res.json = JSON.parse(res.data):\n   *   });\n   */\n  after(middleware, afterAll = true) {\n    const { after } = this.$$;\n\n    if (afterAll) {\n      after.push(middleware);\n    } else {\n      after.unshift(middleware);\n    }\n\n    return this;\n  }\n\n  /**\n   * @method Ajaxer#before\n   * @public\n   * @param {AjaxerBeforeMiddleware|AjaxerErrorBeforeMiddleware} middleware - Middleware to add.\n   * @param {Boolean|*} [beforeAll = true] - Boolean parameter where to put the middleware.\n   * Truthy parameter stands for \"to the beginning\" and falsey for \"to the end\".\n   * @returns {Ajaxer} Returns this.\n   * @description Middleware that is called before the request.\n   * If the middleware has 2 or less arguments it's treated as success middleware otherwise as an error one.\n   * If the middleware returns a promise it becomes a part of the middleware chain.\n   *\n   * @example\n   * const ajaxer = new Ajaxer()\n   *   .before((err, req) => {\n   *     console.log(err);\n   *\n   *     throw err;\n   *   })\n   *   .before((req) => {\n   *     if (req.url === '/veryLongRequest') {\n   *       req.timeout = 30000;\n   *     }\n   *   });\n   */\n  before(middleware, beforeAll = true) {\n    const { before } = this.$$;\n\n    if (beforeAll) {\n      before.unshift(middleware);\n    } else {\n      before.push(middleware);\n    }\n\n    return this;\n  }\n\n  /**\n   * @method Ajaxer#config\n   * @public\n   * @param {String|AjaxerConfig|AjaxerConfigFunction} [property] - If it's a function\n   * it's called with the fetch config argument, if it's a string the value argument\n   * is used for assigning this property to the fetch config\n   * otherwise it's assigned to the fetch config.\n   * @param {*} [value] - See the property argument.\n   * @returns {Ajaxer|AjaxerConfig} If the argument is present this is returned otherwise the fetch config is returned.\n   * @description Method for getting and setting config.\n   *\n   * @example\n   * const ajaxer = new Ajaxer();\n   *\n   * ajaxer.config({ baseURL: 5000 });\n   * ajaxer.config().timeout; // 5000\n   *\n   * ajaxer.config((config) => {\n   *   config.baseURL += '/api';\n   * });\n   */\n  config(property, value) {\n    const config = this.$$;\n\n    if (!arguments.length) {\n      return config;\n    }\n\n    if (isFunction(property)) {\n      property(config);\n    } else {\n      if (arguments.length >= 2) {\n        property = { [property]: value };\n      }\n\n      deepAssign(config, property);\n    }\n\n    return this;\n  }\n\n  /**\n   * @method Ajaxer#delete\n   * @public\n   * @param {String} [url] - See {@link Ajaxer#request}.\n   * @param {AjaxerConfig} [config] - See {@link Ajaxer#request}.\n   * @returns {Promise.<AjaxerResponse, Error>} See {@link Ajaxer#request}.\n   * @description Shorthand for #request for delete requests.\n   *\n   * @example\n   * ajaxer.delete('/data').then((res) => {\n   *   console.log(res);\n   * });\n   */\n  delete(url, config = {}) {\n    if (!isString(url)) {\n      config = url;\n      url = undefined;\n    }\n\n    return this.request(url, assign({ method: 'delete' }, config));\n  }\n\n  /**\n   * @method Ajaxer#get\n   * @public\n   * @param {String} [url] - See {@link Ajaxer#request}.\n   * @param {AjaxerConfig} [config] - See {@link Ajaxer#request}.\n   * @returns {Promise.<AjaxerResponse, Error>} See {@link Ajaxer#request}.\n   * @description Shorthand for #request for get requests.\n   *\n   * @example\n   * ajaxer.get('/data').then((res) => {\n   *   console.log(res);\n   * });\n   */\n  get(url, config = {}) {\n    if (!isString(url)) {\n      config = url;\n      url = undefined;\n    }\n\n    return this.request(url, assign({ method: 'get' }, config));\n  }\n\n  /**\n   * @method Ajaxer#head\n   * @public\n   * @param {String} [url] - See {@link Ajaxer#request}.\n   * @param {AjaxerConfig} [config] - See {@link Ajaxer#request}.\n   * @returns {Promise.<AjaxerResponse, Error>} See {@link Ajaxer#request}.\n   * @description Shorthand for #request for head requests.\n   *\n   * @example\n   * ajaxer.head('/data').then((res) => {\n   *   console.log(res);\n   * });\n   */\n  head(url, config = {}) {\n    if (!isString(url)) {\n      config = url;\n      url = undefined;\n    }\n\n    return this.request(url, assign({ method: 'head' }, config));\n  }\n\n  /**\n   * @method Ajaxer#headers\n   * @public\n   * @param {String|Object.<String, String>} header - A header string or an object of the following format:\n   * { [header]: [value1, value2, ...] }.\n   * @param {String} [value] - Header value. If the first argument is a string\n   * this has to be a header value.\n   * @returns {Ajaxer} Returns this.\n   * @description Method for setting request headers.\n   *\n   * @example\n   * ajaxer\n   *   .headers('My-Header', 'Value')\n   *   .headers({\n   *     'My-Another-Header': 'Value2'\n   *   });\n   */\n  headers(header, value) {\n    const { headers } = this.$$;\n\n    if (arguments.length >= 2) {\n      header = { [header]: value };\n    }\n\n    iterate(header, (value, header) => {\n      headers[header] = value;\n    });\n\n    return this;\n  }\n\n  /**\n   * @method Ajaxer#instance\n   * @public\n   * @param {AjaxerConfig} [config] - New config if needed.\n   * @returns {Ajaxer} New instance of Ajaxer.\n   * @description Method for creating new ajaxer instances based on already existent.\n   *\n   * @example\n   * const mainAjaxer = new Ajaxer({\n   *   baseURL: '//other.domain.com/api',\n   *   withCredentials: true\n   * });\n   *\n   * const longAjaxer = mainAjaxer.instance({\n   *   timeout: 10000\n   * });\n   */\n  instance(config = {}) {\n    const dataConfig = hasOwn(config, 'data')\n      ? { data: config.data }\n      : {};\n\n    delete config.data;\n\n    const conf = assign(\n      deepAssign({}, this.$$, config),\n      dataConfig\n    );\n\n    return new Ajaxer(conf);\n  }\n\n  /**\n   * @method Ajaxer#patch\n   * @public\n   * @param {String} [url] - See {@link Ajaxer#request}.\n   * @param {*} [data] - Additional parameter for uploading data.\n   * @param {AjaxerConfig} [config] - See {@link Ajaxer#request}.\n   * @returns {Promise.<AjaxerResponse, Error>} See {@link Ajaxer#request}.\n   * @description Shorthand for #request for head requests.\n   *\n   * @example\n   * ajaxer.patch('/data', { user: 'John' }).then((res) => {\n   *   console.log(res);\n   * });\n   */\n  patch(url, data = {}, config = {}) {\n    if (arguments.length && !isString(url)) {\n      config = data;\n      data = url;\n      url = undefined;\n    }\n\n    return this.request(url, assign({ method: 'patch', data }, config));\n  }\n\n  /**\n   * @method Ajaxer#post\n   * @public\n   * @param {String} [url] - See {@link Ajaxer#request}.\n   * @param {*} [data] - Additional parameter for uploading data.\n   * @param {AjaxerConfig} [config] - See {@link Ajaxer#request}.\n   * @returns {Promise.<AjaxerResponse, Error>} See {@link Ajaxer#request}.\n   * @description Shorthand for #request for head requests.\n   *\n   * @example\n   * ajaxer.post('/data', { user: 'John' }).then((res) => {\n   *   console.log(res);\n   * });\n   */\n  post(url, data = {}, config = {}) {\n    if (arguments.length && !isString(url)) {\n      config = data;\n      data = url;\n      url = undefined;\n    }\n\n    return this.request(url, assign({ method: 'post', data }, config));\n  }\n\n  /**\n   * @method Ajaxer#put\n   * @public\n   * @param {String} [url] - See {@link Ajaxer#request}.\n   * @param {*} [data] - Additional parameter for uploading data.\n   * @param {AjaxerConfig} [config] - See {@link Ajaxer#request}.\n   * @returns {Promise.<AjaxerResponse, Error>} See {@link Ajaxer#request}.\n   * @description Shorthand for #request for head requests.\n   *\n   * @example\n   * ajaxer.put('/data', { user: 'John' }).then((res) => {\n   *   console.log(res);\n   * });\n   */\n  put(url, data = {}, config = {}) {\n    if (arguments.length && !isString(url)) {\n      config = data;\n      data = url;\n      url = undefined;\n    }\n\n    return this.request(url, assign({ method: 'put', data }, config));\n  }\n\n  /**\n   * @method Ajaxer#request\n   * @public\n   * @param {String} [url] - URL for the request.\n   * @param {AjaxerConfig} [config] - Additional config for this particular request.\n   * @returns {Promise.<AjaxerResponse, Error>} Promise that is resolved with the request response.\n   * @description Main function for making requests. All request methods call this method\n   * including the fetch instance itself.\n   *\n   * @example\n   * ajaxer.request('/data', { timeout: 1000 }).then((res) => {\n   *   console.log(res);\n   * });\n   *\n   * ajaxer.request({ timeout: 1000 }).then((res) => {\n   *   console.log(res);\n   * });\n   *\n   * ajaxer.request().then((res) => {\n   *   console.log(res);\n   * });\n   */\n  request(url, config = {}) {\n    if (arguments.length === 1 && !isString(url)) {\n      config = url;\n    }\n\n    const dataConfig = hasOwn(config, 'data')\n      ? { data: config.data }\n      : {};\n    const urlConfig = isString(url)\n      ? { url }\n      : {};\n\n    delete config.data;\n\n    const conf = assign(\n      deepAssign(\n        deepClone(this.$$),\n        urlConfig,\n        config\n      ),\n      dataConfig\n    );\n\n    let xhr;\n    let promise = Promise.resolve();\n\n    iterate(conf.before, (middleware) => {\n      promise = promise.then(() => {\n        if (middleware.length >= 2) {\n          return Promise.resolve();\n        }\n\n        return new Promise((resolve) => {\n          resolve(middleware(conf));\n        });\n      }, (err) => {\n        if (middleware.length < 2) {\n          return Promise.reject(err);\n        }\n\n        return new Promise((resolve) => {\n          resolve(middleware(err, conf));\n        });\n      });\n    });\n\n    promise = promise.then(() => new Promise((resolve, reject) => {\n      const {\n        after,\n        auth: {\n          username,\n          password\n        },\n        data,\n        headers,\n        method,\n        onprogress,\n        responseType,\n        timeout,\n        url,\n        withCredentials\n      } = conf;\n\n      xhr = new XMLHttpRequest();\n\n      xhr.open(method, url, true, username, password);\n\n      iterate(headers, (value, header) => {\n        xhr.setRequestHeader(header, value);\n      });\n\n      if (onprogress) {\n        if (uploadMethods.indexOf(method) === -1) {\n          xhr.onprogress = onprogress;\n        } else {\n          xhr.upload.onprogress = onprogress;\n        }\n      }\n\n      xhr.onabort = () => {\n        const error = new Error('Request was aborted');\n\n        error.type = 'ABORT_ERROR';\n\n        reject(error);\n\n        xhr = null;\n      };\n\n      xhr.onerror = () => {\n        const error = new Error('Network error');\n\n        error.type = 'NETWORK_ERROR';\n\n        reject(error);\n\n        xhr = null;\n      };\n\n      xhr.ontimeout = () => {\n        const error = new Error('Request time exceeded');\n\n        error.type = 'TIMEOUT_ERROR';\n\n        reject(error);\n\n        xhr = null;\n      };\n\n      xhr.onreadystatechange = () => {\n        if (!xhr || !xhr.status || xhr.readyState !== 4) {\n          return;\n        }\n\n        const response = {\n          config: conf,\n          data: !responseType || responseType === 'text' ? xhr.responseText : xhr.response,\n          headers: parseHeaders(xhr.getAllResponseHeaders()),\n          status: xhr.status === 1223 ? 204 : xhr.status,\n          statusText: xhr.status === 1223 ? 'No Content' : xhr.statusText,\n          xhr\n        };\n\n        let promise = Promise.resolve();\n\n        iterate(after, (middleware) => {\n          promise = promise.then(() => {\n            if (middleware.length >= 2) {\n              return Promise.resolve();\n            }\n\n            return new Promise((resolve) => {\n              resolve(middleware(response));\n            });\n          }, (err) => {\n            if (middleware.length < 2) {\n              return Promise.reject(err);\n            }\n\n            return new Promise((resolve) => {\n              resolve(middleware(err, response));\n            });\n          });\n        });\n\n        resolve(promise\n          .then(() => response)\n          .catch((err) => {\n            try {\n              err.response = response;\n            } catch (e) {\n              throw err;\n            }\n\n            throw err;\n          })\n        );\n      };\n\n      xhr.responseType = responseType;\n      xhr.timeout = +timeout || 0;\n      xhr.withCredentials = !!withCredentials;\n\n      xhr.send(data);\n    }));\n\n    promise.abort = function abort() {\n      if (xhr) {\n        xhr.abort();\n      }\n\n      return this;\n    };\n\n    return promise;\n  }\n}\n\nfunction fetchBeforeMiddleware(config) {\n  const {\n    baseURL,\n    data,\n    headers,\n    method,\n    params,\n    query,\n    url\n  } = config;\n  const METHOD = method.toUpperCase();\n\n  config.method = METHOD;\n  config.url = constructURL(baseURL, url, params, query);\n  config.data = transformData(data, METHOD, headers);\n}\n\n/**\n * @const {Ajaxer} fetch\n * @type {Ajaxer}\n * @public\n * @description Empty instance of Ajaxer.\n */\nconst fetch = new Ajaxer();\n\nexport default Ajaxer;\nexport { Ajaxer, Promise, fetch };\n","/* eslint no-nested-ternary: 0 */\n/* eslint no-negated-condition: 0 */\nexport default typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n","import { isFunction } from './utils';\n\n/**\n * @callback onFulfilledOrRejected\n * @public\n * @param {*} value - Promise value.\n * @param {Boolean} success - If the previous promise is fulfilled it's true and false if rejected.\n */\n\n/**\n * @callback onRejected\n * @public\n * @param {Error|*} err - Promise error.\n */\n\n/**\n * @callback onFulfilled\n * @public\n * @param {*} value - Promise value.\n */\n\nconst secret = {};\nconst iterator = global.Symbol\n  ? Symbol.iterator\n  : Math.random().toString(36);\n\n/**\n * @class Promise\n * @public\n * @param {Function} executor - Function that takes two arguments: resolve and reject functions.\n * Call the resolve function when you need to fulfill the promise and call the reject one\n * when you need to reject it.\n * @returns {Promise} Instance of Promise.\n * @see https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise\n * @description Class with almost identical API to\n * [ES6 Promise]{@link https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise}.\n * There is a couple differences: set Promise.onError to a function with which you want to\n * subscribe to a promise error and set Promise.onUnhandledRejection to a function with which\n * you want to subscribe to an unhandled error\n * (defaults to console.error.bind(console, '%s %o', 'Uncaught (in promise)')).\n */\nclass Promise {\n  constructor(executor) {\n    if (!isFunction(executor)) {\n      throw new TypeError(`Promise resolver ${ {}.toString.call(executor) } is not a function`);\n    }\n\n    let hiddenStatus;\n    let hiddenValue;\n\n    const\tonFulfill = [];\n    const onReject = [];\n    const realPromise = this;\n    const hiddenPromise = {\n      handled: false,\n      get status() {\n        return hiddenStatus;\n      },\n      set status(value) {\n        hiddenStatus = value;\n        realPromise.status = value;\n      },\n      get value() {\n        return hiddenValue;\n      },\n      set value(val) {\n        hiddenValue = val;\n        realPromise.value = val;\n      }\n    };\n\n    hiddenPromise.status = 'pending';\n    hiddenPromise.value = undefined;\n\n    Object.defineProperties(this.$$ = {}, {\n      handled: {\n        get() {\n          return hiddenPromise.handled;\n        },\n        set(key) {\n          if (key === secret) {\n            hiddenPromise.handled = true;\n          }\n        }\n      },\n      handle: {\n        value(status, f, resolve, reject, key) {\n          if (key === secret) {\n            let proxy = null;\n\n            if (isFunction(f)) {\n              proxy = (value) => {\n                try {\n                  resolve(f(value));\n                } catch (err) {\n                  reject(err);\n                }\n              };\n            }\n\n            if (status === 'resolve') {\n              onFulfill.push(proxy || ((value) => resolve(value)));\n            } else if (status === 'reject') {\n              onReject.push(proxy || ((err) => reject(err)));\n            }\n          }\n        }\n      },\n      status: {\n        get() {\n          return hiddenPromise.status;\n        }\n      },\n      value: {\n        get() {\n          return hiddenPromise.value;\n        }\n      }\n    });\n\n    try {\n      executor(resolve, reject);\n    } catch (err) {\n      reject(err);\n    }\n\n    function reject(err) {\n      if (hiddenPromise.status === 'pending') {\n        hiddenPromise.status = 'rejected';\n        hiddenPromise.value = err;\n\n        for (let i = 0, length = onReject.length; i < length; i++) {\n          hiddenPromise.handled = true;\n\n          onReject[i](err);\n        }\n\n        const {\n          onUnhandledRejection,\n          onError\n        } = Promise;\n\n        if (isFunction(onError)) {\n          onError(err);\n        }\n\n        setTimeout(() => {\n          if (!hiddenPromise.handled && isFunction(onUnhandledRejection)) {\n            onUnhandledRejection(err);\n          }\n        }, 1);\n      }\n    }\n\n    function resolve(value) {\n      if (hiddenPromise.status === 'pending') {\n        if (value && isFunction(value.then)) {\n          return value.then((value) => {\n            resolve(value);\n          }, (err) => {\n            reject(err);\n          });\n        }\n\n        hiddenPromise.status = 'fulfilled';\n        hiddenPromise.value = value;\n\n        for (let i = 0, length = onFulfill.length; i < length; i++) {\n          hiddenPromise.handled = true;\n\n          onFulfill[i](value);\n        }\n      }\n    }\n  }\n\n  /**\n   * @method Promise.all\n   * @param {(Array|Iterable).<Promise|*>} iterable - Iterable object (like array) of promises\n   * or any values.\n   * @returns {Promise} New instance of Promise.\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all\n   */\n  static all(iterable) {\n    const array = [];\n\n    let toResolve = 0;\n\n    if (iterable[iterator]) {\n      iterable = iterable[iterator]();\n\n      return new Promise((resolve, reject) => {\n        let next;\n        let i = 0;\n\n        while (!(next = iterable.next()).done) {\n          const promise = Promise.resolve(next.value);\n\n          toResolve++;\n\n          ((i) => {\n            promise.then((value) => {\n              toResolve--;\n              array[i] = value;\n\n              setTimeout(() => {\n                if (next.done && !toResolve) {\n                  resolve(array);\n                }\n              }, 1);\n            }, reject);\n          })(i++);\n        }\n\n        if (!i) {\n          return Promise.resolve([]);\n        }\n      });\n    }\n\n    const length = iterable.length;\n\n    if (!length) {\n      return Promise.resolve([]);\n    }\n\n    toResolve = length;\n\n    return new Promise((resolve, reject) => {\n      for (let i = 0; i < length; i++) {\n        const promise = Promise.resolve(iterable[i]);\n\n        promise.then((value) => {\n          toResolve--;\n          array[i] = value;\n\n          if (!toResolve) {\n            resolve(array);\n          }\n        }, reject);\n      }\n    });\n  }\n\n  /**\n   * @method Promise.race\n   * @param {(Array|Iterable).<Promise|*>} iterable - Iterable object (like array) of promises\n   * or any values.\n   * @returns {Promise} New instance of Promise.\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/race\n   */\n  static race(iterable) {\n    if (iterable[iterator]) {\n      iterable = iterable[iterator]();\n\n      return new Promise((resolve, reject) => {\n        let next;\n\n        while (!(next = iterable.next()).done) {\n          next.value.then(resolve, reject);\n        }\n      });\n    }\n\n    return new Promise((resolve, reject) => {\n      for (let i = 0, length = iterable.length; i < length; i++) {\n        iterable[i].then(resolve, reject);\n      }\n    });\n  }\n\n  /**\n   * @method Promise.reject\n   * @param {*} value - Value to reject.\n   * @returns {Promise} New instance of Promise.\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/reject\n   */\n  static reject(value) {\n    return new Promise((resolve, reject) => {\n      reject(value);\n    });\n  }\n\n  /**\n   * @method Promise.resolve\n   * @param {Promise|Thenable|*} value - Promise, thenable or any value to resolve.\n   * @returns {Promise} New instance of Promise.\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/resolve\n   */\n  static resolve(value) {\n    if (value && isFunction(value.then)) {\n      return value;\n    }\n\n    return new Promise((resolve) => {\n      resolve(value);\n    });\n  }\n\n  abort() {}\n\n  /**\n   * @method Promise#catch\n   * @param {onRejected} onRejected - onRejected callback.\n   * @returns {Promise} New instance of Promise.\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/catch\n   */\n  catch(onRejected) {\n    return this.then(null, onRejected);\n  }\n\n  /**\n   * @method Promise#finally\n   * @public\n   * @param {onFulfilledOrRejected} onFulfilledOrRejected - onFulfilledOrRejected callback.\n   * @returns {Promise}\n   * @description Method for catching both fulfilled and rejected promises.\n   *\n   * @example\n   * spinner.show();\n   * fetchData()\n   *   .then((data) => {\n   *     // do something with data\n   *   })\n   *   .catch((err) => {\n   *     // handle error somehow\n   *   })\n   *   .finally(() => {\n   *     spinner.hide();\n   *   });\n   */\n  finally(onFulfilledOrRejected) {\n    const isFunc = isFunction(onFulfilledOrRejected);\n\n    return this.then((value) => (\n      Promise\n        .resolve(\n          isFunc\n            ? onFulfilledOrRejected(value, true)\n            : 0\n        )\n        .then(() => value)\n    ), (err) => (\n      Promise\n        .resolve(\n          isFunc\n            ? onFulfilledOrRejected(err, false)\n            : 0\n        )\n        .then(() => Promise.reject(err))\n    ));\n  }\n\n  /**\n   * @method Promise#then\n   * @param {onFulfilled} [onFulfilled] - onFulfilled callback.\n   * @param {onRejected} [onRejected] - onRejected callback.\n   * @returns {Promise} New instance of Promise.\n   * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then\n   */\n  then(onFulfilled, onRejected) {\n    const promise = this.$$;\n\n    if (promise.status === 'pending') {\n      return new Promise((resolve, reject) => {\n        promise.handle('reject', onRejected, resolve, reject, secret);\n        promise.handle('resolve', onFulfilled, resolve, reject, secret);\n      });\n    }\n\n    promise.handled = secret;\n\n    const { value } = promise;\n\n    let method;\n    let handler;\n\n    if (promise.status === 'fulfilled') {\n      method = 'resolve';\n      handler = onFulfilled;\n    } else {\n      method = 'reject';\n      handler = onRejected;\n    }\n\n    if (!isFunction(handler)) {\n      return Promise[method](value);\n    }\n\n    try {\n      return Promise.resolve(handler(value));\n    } catch (err) {\n      return Promise.reject(err);\n    }\n  }\n}\n\nPromise.onError = null;\nPromise.onUnhandledRejection = console.error.bind(console, '%s %o', 'Uncaught (in promise)');\n\nexport default Promise;\n","import {\n  iterate,\n  trim\n} from './utils';\n\nexport default (rawHeaders) => {\n  const headers = {};\n\n  iterate((rawHeaders || '').split('\\n'), (value) => {\n    const index = value.indexOf(':');\n    const key = trim(value.substring(0, index));\n    const val = trim(value.substring(index + 1));\n\n    if (key) {\n      headers[key] = (headers[key] ? `${ headers[key] }, ` : '') + val;\n    }\n  });\n\n  return headers;\n};\n","import {\n  isObject,\n  toStringTag\n} from './utils';\n\nconst notToTransform = ['FormData', 'File', 'Blob', 'ArrayBuffer', 'String', 'Number'];\nconst withoutBody = ['DELETE', 'GET', 'HEAD'];\n\nexport default (data, method, headers) => {\n  if (withoutBody.indexOf(method) !== -1) {\n    return null;\n  }\n\n  if (isObject(data) && notToTransform.indexOf(toStringTag(data)) === -1) {\n    if (!headers['Content-Type']) {\n      headers['Content-Type'] = 'application/json;charset=utf-8';\n    }\n\n    return JSON.stringify(data);\n  }\n\n  return data;\n};\n","import Ajaxer from './lib/Ajaxer';\n\nwindow.Ajaxer = Ajaxer;\n"],"names":["toStringTag","value","toString","call","slice","isFunction","isObject","isPrimitive","test","isString","assign","target","objects","source","key","iterate","object","callback","array","isArray","iterated","length","hasOwnProperty","map","newObject","trim","string","replace","whiteSpace","replaceString","stringToReplace","replacement","split","join","deepClone","clone","deepAssign","hasOwn","property","isAbsolute","url","absoluteURLRegexp","encode","encodeURIComponent","querySwitcher","query","prefix","queryParams","push","param","String","emptyArray","fetchBeforeMiddleware","config","baseURL","data","headers","method","params","METHOD","toUpperCase","constructURL","transformData","window","global","self","Array","secret","iterator","Symbol","Math","random","Promise","executor","reject","err","hiddenPromise","status","i","onReject","handled","onUnhandledRejection","onError","resolve","then","onFulfill","TypeError","hiddenStatus","hiddenValue","realPromise","this","val","undefined","defineProperties","$$","f","proxy","onRejected","onFulfilledOrRejected","isFunc","onFulfilled","promise","handle","handler","iterable","toResolve","next","done","console","error","bind","URL","indexOf","postfix","rawHeaders","index","substring","notToTransform","withoutBody","JSON","stringify","defaults","location","origin","uploadMethods","Ajaxer","ajaxer","request","apply","arguments","conf","before","defineProperty","setPrototypeOf","prototype","middleware","afterAll","after","unshift","beforeAll","header","dataConfig","urlConfig","xhr","auth","username","password","onprogress","responseType","timeout","withCredentials","XMLHttpRequest","open","setRequestHeader","upload","onabort","Error","type","onerror","ontimeout","onreadystatechange","readyState","response","responseText","parseHeaders","getAllResponseHeaders","statusText","catch","e","send","abort","Function"],"mappings":"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","preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWpheGVyLmpzIiwic291cmNlcyI6WyIuLi9saWIvdXRpbHMuanMiLCIuLi9saWIvY29uc3RydWN0VVJMLmpzIiwiLi4vbGliL0FqYXhlci5qcyIsIi4uL2xpYi9nbG9iYWwuanMiLCIuLi9saWIvUHJvbWlzZS5qcyIsIi4uL2xpYi9wYXJzZUhlYWRlcnMuanMiLCIuLi9saWIvdHJhbnNmb3JtRGF0YS5qcyIsIi4uL2Jyb3dzZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qge1xuICBoYXNPd25Qcm9wZXJ0eSxcbiAgdG9TdHJpbmdcbn0gPSB7fTtcbmNvbnN0IHdoaXRlU3BhY2UgPSAvXlxccyp8XFxzKiQvZztcbmNvbnN0IHByaW1pdGl2ZSA9IC9eKG51bWJlcnxzdHJpbmd8Ym9vbGVhbnxzeW1ib2x8dW5kZWZpbmVkKSQvO1xuXG5leHBvcnQgZnVuY3Rpb24gdG9TdHJpbmdUYWcodmFsdWUpIHtcbiAgcmV0dXJuIHRvU3RyaW5nXG4gICAgLmNhbGwodmFsdWUpXG4gICAgLnNsaWNlKDgsIC0xKTtcbn1cblxuZXhwb3J0IGNvbnN0IGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8ICgodmFsdWUpID0+IChcbiAgdG9TdHJpbmdUYWcodmFsdWUpID09PSAnQXJyYXknXG4pKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsdWUpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJyB8fCB0b1N0cmluZ1RhZyh2YWx1ZSkgPT09ICdGdW5jdGlvbic7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc09iamVjdCh2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlICYmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnIHx8IGlzRnVuY3Rpb24odmFsdWUpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUHJpbWl0aXZlKHZhbHVlKSB7XG4gIHJldHVybiB2YWx1ZSA9PT0gbnVsbCB8fCAvXihudW1iZXJ8c3RyaW5nfGJvb2xlYW58c3ltYm9sfHVuZGVmaW5lZCkkLy50ZXN0KHR5cGVvZiB2YWx1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1N0cmluZyh2YWx1ZSkge1xuICByZXR1cm4gdG9TdHJpbmdUYWcodmFsdWUpID09PSAnU3RyaW5nJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQsIC4uLm9iamVjdHMpIHtcbiAgaXRlcmF0ZShvYmplY3RzLCAoc291cmNlKSA9PiB7XG4gICAgaXRlcmF0ZShzb3VyY2UsICh2YWx1ZSwga2V5KSA9PiB7XG4gICAgICB0YXJnZXRba2V5XSA9IHZhbHVlO1xuICAgIH0pO1xuICB9KTtcblxuICByZXR1cm4gdGFyZ2V0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXRlcmF0ZShvYmplY3QsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IGFycmF5ID0gaXNBcnJheShvYmplY3QpO1xuXG4gIGxldCBpdGVyYXRlZCA9IDA7XG4gIGNvbnN0IHsgbGVuZ3RoIH0gPSBvYmplY3QgfHwge307XG5cbiAgZm9yIChjb25zdCBrZXkgaW4gb2JqZWN0KSB7XG4gICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBrZXkpKSB7XG4gICAgICBpZiAoYXJyYXkgJiYgaXRlcmF0ZWQrKyA+PSBsZW5ndGgpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGNhbGxiYWNrKG9iamVjdFtrZXldLCBhcnJheSA/ICtrZXkgOiBrZXksIG9iamVjdCk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXAob2JqZWN0LCBjYWxsYmFjaykge1xuICBjb25zdCBuZXdPYmplY3QgPSBpc0FycmF5KG9iamVjdClcbiAgICA/IFtdXG4gICAgOiB7fTtcblxuICBpdGVyYXRlKG9iamVjdCwgKHZhbHVlLCBrZXkpID0+IHtcbiAgICBuZXdPYmplY3Rba2V5XSA9IGNhbGxiYWNrKHZhbHVlLCBrZXksIG9iamVjdCk7XG4gIH0pO1xuXG4gIHJldHVybiBuZXdPYmplY3Q7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0cmltKHN0cmluZykge1xuICByZXR1cm4gc3RyaW5nLnJlcGxhY2Uod2hpdGVTcGFjZSwgJycpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVwbGFjZVN0cmluZyhzdHJpbmcsIHN0cmluZ1RvUmVwbGFjZSwgcmVwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIHN0cmluZ1xuICAgIC5zcGxpdChzdHJpbmdUb1JlcGxhY2UpXG4gICAgLmpvaW4ocmVwbGFjZW1lbnQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVlcENsb25lKG9iamVjdCkge1xuICBpZiAoaXNQcmltaXRpdmUob2JqZWN0KSB8fCBpc0Z1bmN0aW9uKG9iamVjdCkpIHtcbiAgICByZXR1cm4gb2JqZWN0O1xuICB9XG5cbiAgY29uc3QgY2xvbmUgPSBpc0FycmF5KG9iamVjdClcbiAgICA/IFtdXG4gICAgOiB7fTtcblxuICBpdGVyYXRlKG9iamVjdCwgKHZhbHVlLCBrZXkpID0+IHtcbiAgICBjbG9uZVtrZXldID0gZGVlcENsb25lKHZhbHVlKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGNsb25lO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVlcEFzc2lnbih0YXJnZXQsIC4uLm9iamVjdHMpIHtcbiAgaXRlcmF0ZShvYmplY3RzLCAob2JqZWN0KSA9PiB7XG4gICAgaXRlcmF0ZShvYmplY3QsIChvYmplY3QsIGtleSkgPT4ge1xuICAgICAgaWYgKGlzUHJpbWl0aXZlKG9iamVjdCkgfHwgIWhhc093blByb3BlcnR5LmNhbGwodGFyZ2V0LCBrZXkpKSB7XG4gICAgICAgIHRhcmdldFtrZXldID0gZGVlcENsb25lKG9iamVjdCk7XG5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWlzUHJpbWl0aXZlKHRhcmdldFtrZXldKSkge1xuICAgICAgICBkZWVwQXNzaWduKHRhcmdldFtrZXldLCBvYmplY3QpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICByZXR1cm4gdGFyZ2V0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzT3duKG9iamVjdCwgcHJvcGVydHkpIHtcbiAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7XG59XG4iLCJpbXBvcnQge1xuICBpc0FycmF5LFxuICBpc09iamVjdCxcbiAgaXRlcmF0ZSxcbiAgbWFwLFxuICByZXBsYWNlU3RyaW5nXG59IGZyb20gJy4vdXRpbHMnO1xuXG5jb25zdCBhYnNvbHV0ZVVSTFJlZ2V4cCA9IC9eKChbYS16XVthLXpcXGQrXFwtLl0qOik/XFwvXFwvfGRhdGE6W2Etel0rXFwvW2Etel0rO2Jhc2U2NCwpL2k7XG5jb25zdCBlbXB0eUFycmF5ID0gW107XG5cbmV4cG9ydCBkZWZhdWx0IChiYXNlVVJMLCB1cmwsIHBhcmFtcywgcXVlcnkpID0+IHtcbiAgbGV0IFVSTCA9IGlzQWJzb2x1dGUodXJsKVxuICAgID8gdXJsXG4gICAgOiBgJHsgU3RyaW5nKGJhc2VVUkwpLnJlcGxhY2UoL1xcLyskLywgJycpIH0vJHsgU3RyaW5nKHVybCkucmVwbGFjZSgvXlxcLysvLCAnJykgfWA7XG5cbiAgaXRlcmF0ZShwYXJhbXMsICh2YWx1ZSwgcGFyYW0pID0+IHtcbiAgICBVUkwgPSByZXBsYWNlU3RyaW5nKFVSTCwgYDokeyBwYXJhbSB9YCwgZW5jb2RlKHZhbHVlKSk7XG4gIH0pO1xuXG4gIGNvbnN0IHF1ZXJ5UGFyYW1zID0gcXVlcnlTd2l0Y2hlcihxdWVyeSwgJycpO1xuXG4gIGlmIChxdWVyeVBhcmFtcy5sZW5ndGgpIHtcbiAgICBjb25zdCBwcmVmaXggPSBVUkwuaW5kZXhPZignPycpID09PSAtMSA/ICc/JyA6ICcmJztcbiAgICBjb25zdCBwb3N0Zml4ID0gbWFwKHF1ZXJ5UGFyYW1zLCAoeyBwYXJhbSwgdmFsdWUgfSkgPT4gKFxuICAgICAgYCR7IGVuY29kZShwYXJhbSkgfT0keyBlbmNvZGUodmFsdWUpIH1gXG4gICAgKSkuam9pbignJicpO1xuXG4gICAgVVJMICs9IHByZWZpeCArIHBvc3RmaXg7XG4gIH1cblxuICByZXR1cm4gVVJMO1xufTtcblxuZnVuY3Rpb24gaXNBYnNvbHV0ZSh1cmwpIHtcbiAgcmV0dXJuIGFic29sdXRlVVJMUmVnZXhwLnRlc3QodXJsKTtcbn1cblxuZnVuY3Rpb24gZW5jb2RlKHN0cmluZykge1xuICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZyk7XG59XG5cbmZ1bmN0aW9uIHF1ZXJ5U3dpdGNoZXIocXVlcnksIHByZWZpeCkge1xuICAvKiBlc2xpbnQgaW5kZW50OiAwICovXG4gIHN3aXRjaCAodHJ1ZSkge1xuICAgIGNhc2UgaXNBcnJheShxdWVyeSk6IHtcbiAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0gW107XG5cbiAgICAgIGl0ZXJhdGUocXVlcnksICh2YWx1ZSkgPT4ge1xuICAgICAgICBpZiAoaXNPYmplY3QodmFsdWUpKSB7XG4gICAgICAgICAgcmV0dXJuIHF1ZXJ5UGFyYW1zLnB1c2goLi4ucXVlcnlTd2l0Y2hlcih2YWx1ZSwgYCR7IHByZWZpeCB9W11gKSk7XG4gICAgICAgIH1cblxuICAgICAgICBxdWVyeVBhcmFtcy5wdXNoKHtcbiAgICAgICAgICBwYXJhbTogYCR7IHByZWZpeCB9W11gLFxuICAgICAgICAgIHZhbHVlXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBxdWVyeVBhcmFtcztcbiAgICB9XG5cbiAgICBjYXNlIGlzT2JqZWN0KHF1ZXJ5KToge1xuICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSBbXTtcblxuICAgICAgaXRlcmF0ZShxdWVyeSwgKHZhbHVlLCBwYXJhbSkgPT4ge1xuICAgICAgICBpZiAoaXNPYmplY3QodmFsdWUpKSB7XG4gICAgICAgICAgcXVlcnlQYXJhbXMucHVzaCguLi5xdWVyeVN3aXRjaGVyKHZhbHVlLCBwcmVmaXggPyBgJHsgcHJlZml4IH1bJHsgcGFyYW0gfV1gIDogcGFyYW0pKTtcblxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHF1ZXJ5UGFyYW1zLnB1c2goe1xuICAgICAgICAgIHBhcmFtOiBwcmVmaXggPyBgJHsgcHJlZml4IH1bJHsgcGFyYW0gfV1gIDogcGFyYW0sXG4gICAgICAgICAgdmFsdWU6IFN0cmluZyh2YWx1ZSlcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHF1ZXJ5UGFyYW1zO1xuICAgIH1cblxuICAgIGRlZmF1bHQ6IHtcbiAgICAgIHJldHVybiBlbXB0eUFycmF5O1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHtcbiAgaXNGdW5jdGlvbixcbiAgaXNTdHJpbmcsXG4gIGFzc2lnbixcbiAgaXRlcmF0ZSxcbiAgZGVlcEFzc2lnbixcbiAgZGVlcENsb25lLFxuICBoYXNPd25cbn0gZnJvbSAnLi91dGlscyc7XG5cbmltcG9ydCBQcm9taXNlIGZyb20gJy4vUHJvbWlzZSc7XG5cbmltcG9ydCBjb25zdHJ1Y3RVUkwgZnJvbSAnLi9jb25zdHJ1Y3RVUkwnO1xuaW1wb3J0IHBhcnNlSGVhZGVycyBmcm9tICcuL3BhcnNlSGVhZGVycyc7XG5pbXBvcnQgdHJhbnNmb3JtRGF0YSBmcm9tICcuL3RyYW5zZm9ybURhdGEnO1xuXG4vKipcbiAqIEB0eXBlZGVmIHsnZ2V0J3wncG9zdCd8J2RlbGV0ZSd8J2hlYWQnfCdwdXQnfCdwYXRjaCd9IEFqYXhlck1ldGhvZFxuICogQHB1YmxpY1xuICovXG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQWpheGVyQ29uZmlnXG4gKiBAcHVibGljXG4gKiBAcHJvcGVydHkge0FycmF5LjxBamF4ZXJBZnRlck1pZGRsZXdhcmV8QWpheGVyRXJyb3JBZnRlck1pZGRsZXdhcmU+fSBbYWZ0ZXJdXG4gKiBAcHJvcGVydHkge09iamVjdH0gW2F1dGhdXG4gKiBAcHJvcGVydHkge1N0cmluZ30gW2F1dGgudXNlcm5hbWVdXG4gKiBAcHJvcGVydHkge1N0cmluZ30gW2F1dGgucGFzc3dvcmRdXG4gKiBAcHJvcGVydHkge1N0cmluZ30gW2Jhc2VVUkxdXG4gKiBAcHJvcGVydHkge0FycmF5LjxBamF4ZXJCZWZvcmVNaWRkbGV3YXJlfEFqYXhlckVycm9yQmVmb3JlTWlkZGxld2FyZT59IFtiZWZvcmVdXG4gKiBAcHJvcGVydHkgeyp9IFtkYXRhXVxuICogQHByb3BlcnR5IHtPYmplY3QuPFN0cmluZywgU3RyaW5nPn0gW2hlYWRlcnNdXG4gKiBAcHJvcGVydHkge0FqYXhlck1ldGhvZH0gW21ldGhvZF1cbiAqIEBwcm9wZXJ0eSB7T2JqZWN0fSBbcGFyYW1zXVxuICogQHByb3BlcnR5IHtPYmplY3R9IFtxdWVyeV1cbiAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBbcmVzcG9uc2VUeXBlXVxuICogQHByb3BlcnR5IHtOdW1iZXJ9IFt0aW1lb3V0XVxuICogQHByb3BlcnR5IHtTdHJpbmd9IFt1cmxdXG4gKiBAcHJvcGVydHkge0Jvb2xlYW59IFt3aXRoQ3JlZGVudGlhbHNdXG4gKi9cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBBamF4ZXJSZXNwb25zZVxuICogQHB1YmxpY1xuICogQHByb3BlcnR5IHtBamF4ZXJDb25maWd9IGNvbmZpZ1xuICogQHByb3BlcnR5IHsqfSBkYXRhXG4gKiBAcHJvcGVydHkge09iamVjdC48U3RyaW5nLCBTdHJpbmc+fSBoZWFkZXJzXG4gKiBAcHJvcGVydHkge051bWJlcn0gc3RhdHVzXG4gKiBAcHJvcGVydHkge1N0cmluZ30gc3RhdHVzVGV4dFxuICogQHByb3BlcnR5IHtYTUxIdHRwUmVxdWVzdH0geGhyXG4gKi9cblxuLyoqXG4gKiBAY2FsbGJhY2sgQWpheGVyQWZ0ZXJNaWRkbGV3YXJlXG4gKiBAcHVibGljXG4gKiBAcGFyYW0ge0FqYXhlclJlc3BvbnNlfSBjb25maWcgLSBBamF4ZXIgcmVzcG9uc2UuXG4gKi9cblxuLyoqXG4gKiBAY2FsbGJhY2sgQWpheGVyRXJyb3JBZnRlck1pZGRsZXdhcmVcbiAqIEBwdWJsaWNcbiAqIEBwYXJhbSB7RXJyb3J8Kn0gZXJyIC0gVGhyb3duIGVycm9yLlxuICogQHBhcmFtIHtBamF4ZXJSZXNwb25zZX0gY29uZmlnIC0gQWpheGVyIHJlc3BvbnNlLlxuICovXG5cbi8qKlxuICogQGNhbGxiYWNrIEFqYXhlckJlZm9yZU1pZGRsZXdhcmVcbiAqIEBwdWJsaWNcbiAqIEBwYXJhbSB7QWpheGVyQ29uZmlnfSBjb25maWcgLSBBamF4ZXIgY29uZmlnLlxuICovXG5cbi8qKlxuICogQGNhbGxiYWNrIEFqYXhlckVycm9yQmVmb3JlTWlkZGxld2FyZVxuICogQHB1YmxpY1xuICogQHBhcmFtIHtFcnJvcnwqfSBlcnIgLSBUaHJvd24gZXJyb3IuXG4gKiBAcGFyYW0ge0FqYXhlckNvbmZpZ30gY29uZmlnIC0gQWpheGVyIGNvbmZpZy5cbiAqL1xuXG4vKipcbiAqIEBjYWxsYmFjayBBamF4ZXJDb25maWdGdW5jdGlvblxuICogQHB1YmxpY1xuICogQHBhcmFtIHtBamF4ZXJDb25maWd9IGNvbmZpZ1xuICovXG5cbmNvbnN0IGRlZmF1bHRzID0ge1xuICBhZnRlcjogW10sXG4gIGF1dGg6IHtcbiAgICB1c2VybmFtZTogJycsXG4gICAgcGFzc3dvcmQ6ICcnXG4gIH0sXG4gIGJhc2VVUkw6IGdsb2JhbC5sb2NhdGlvbi5vcmlnaW4sXG4gIGJlZm9yZTogW10sXG4gIGRhdGE6IG51bGwsXG4gIGhlYWRlcnM6IHt9LFxuICBtZXRob2Q6ICdnZXQnLFxuICBwYXJhbXM6IHt9LFxuICBxdWVyeToge30sXG4gIHJlc3BvbnNlVHlwZTogJycsXG4gIHRpbWVvdXQ6IDAsXG4gIHVybDogJycsXG4gIHdpdGhDcmVkZW50aWFsczogZmFsc2Vcbn07XG5jb25zdCB1cGxvYWRNZXRob2RzID0gWydQT1NUJywgJ1BVVCddO1xuXG4vKipcbiAqIEBjbGFzcyBBamF4ZXJcbiAqIEBleHRlbmRzIEZ1bmN0aW9uXG4gKiBAcHVibGljXG4gKiBAcGFyYW0ge0FqYXhlckNvbmZpZ30gW2NvbmZpZyA9IHt9XSAtIENvbmZpZyB0byBhZGQuXG4gKiBAcmV0dXJucyB7QWpheGVyfSBJbnN0YW5jZSBvZiBBamF4ZXIuXG4gKiBBbiBpbnN0YW5jZSBvZiBBamF4ZXIgaXMgYSBmdW5jdGlvbiB0aGF0IHNpbXBseSBjYWxscyAjcmVxdWVzdCB3aXRoIHRoZSBzYW1lIGFyZ3VtZW50cy5cbiAqIEBkZXNjcmlwdGlvbiBDbGFzcyBmb3IgZmV0Y2hpbmcgZGF0YS5cbiAqXG4gKiBAZXhhbXBsZVxuICogY29uc3QgYWpheGVyID0gbmV3IEFqYXhlcigpO1xuICpcbiAqIGFqYXhlcignL2RhdGEnKS50aGVuKChyZXMpID0+IHtcbiAqICAgY29uc29sZS5sb2cocmVzKTtcbiAqIH0pO1xuICovXG5jbGFzcyBBamF4ZXIgZXh0ZW5kcyBGdW5jdGlvbiB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZyA9IHt9KSB7XG4gICAgc3VwZXIoKTtcblxuICAgIGZ1bmN0aW9uIGFqYXhlcigpIHtcbiAgICAgIHJldHVybiBhamF4ZXIucmVxdWVzdC5hcHBseShhamF4ZXIsIGFyZ3VtZW50cyk7XG4gICAgfVxuXG4gICAgY29uc3QgY29uZiA9IGRlZXBBc3NpZ24oe30sIGRlZmF1bHRzLCBjb25maWcpO1xuXG4gICAgaWYgKGNvbmYuYmVmb3JlLmluZGV4T2YoZmV0Y2hCZWZvcmVNaWRkbGV3YXJlKSA9PT0gLTEpIHtcbiAgICAgIGNvbmYuYmVmb3JlLnB1c2goZmV0Y2hCZWZvcmVNaWRkbGV3YXJlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIHtBamF4ZXJDb25maWd9IEFqYXhlciMkJFxuICAgICAqIEB0eXBlIHtBamF4ZXJDb25maWd9XG4gICAgICogQHB1YmxpY1xuICAgICAqIEBkZXNjcmlwdGlvbiBBamF4ZXIgY29uZmlnLlxuICAgICAqL1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhamF4ZXIsICckJCcsIHsgdmFsdWU6IGNvbmYgfSk7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGFqYXhlciwgQWpheGVyLnByb3RvdHlwZSk7XG5cbiAgICByZXR1cm4gYWpheGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgQWpheGVyI2FmdGVyXG4gICAqIEBwdWJsaWNcbiAgICogQHBhcmFtIHtBamF4ZXJBZnRlck1pZGRsZXdhcmV8QWpheGVyRXJyb3JBZnRlck1pZGRsZXdhcmV9IG1pZGRsZXdhcmUgLSBNaWRkbGV3YXJlIHRvIGFkZC5cbiAgICogQHBhcmFtIHtCb29sZWFufCp9IFthZnRlckFsbCA9IHRydWVdIC0gQm9vbGVhbiBwYXJhbWV0ZXIgd2hlcmUgdG8gcHV0IHRoZSBtaWRkbGV3YXJlLlxuICAgKiBUcnV0aHkgcGFyYW1ldGVyIHN0YW5kcyBmb3IgXCJ0byB0aGUgZW5kXCIgYW5kIGZhbHNleSBmb3IgXCJ0byB0aGUgYmVnaW5uaW5nXCIuXG4gICAqIEByZXR1cm5zIHtBamF4ZXJ9IFJldHVybnMgdGhpcy5cbiAgICogQGRlc2NyaXB0aW9uIE1pZGRsZXdhcmUgdGhhdCBpcyBjYWxsZWQgYWZ0ZXIgdGhlIHJlcXVlc3QuXG4gICAqIElmIHRoZSBtaWRkbGV3YXJlIGhhcyAyIG9yIGxlc3MgYXJndW1lbnRzIGl0J3MgdHJlYXRlZCBhcyBzdWNjZXNzIG1pZGRsZXdhcmUgb3RoZXJ3aXNlIGFzIGFuIGVycm9yIG9uZS5cbiAgICogSWYgdGhlIG1pZGRsZXdhcmUgcmV0dXJucyBhIHByb21pc2UgaXQgYmVjb21lcyBhIHBhcnQgb2YgdGhlIG1pZGRsZXdhcmUgY2hhaW4uXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGNvbnN0IGFqYXhlciA9IG5ldyBBamF4ZXIoKVxuICAgKiAgIC5hZnRlcigoZXJyLCByZXMpID0+IHtcbiAgICogICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAqXG4gICAqICAgICB0aHJvdyBlcnI7XG4gICAqICAgfSlcbiAgICogICAuYWZ0ZXIoKHJlcykgPT4ge1xuICAgKiAgICAgcmVzLmpzb24gPSBKU09OLnBhcnNlKHJlcy5kYXRhKTpcbiAgICogICB9KTtcbiAgICovXG4gIGFmdGVyKG1pZGRsZXdhcmUsIGFmdGVyQWxsID0gdHJ1ZSkge1xuICAgIGNvbnN0IHsgYWZ0ZXIgfSA9IHRoaXMuJCQ7XG5cbiAgICBpZiAoYWZ0ZXJBbGwpIHtcbiAgICAgIGFmdGVyLnB1c2gobWlkZGxld2FyZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFmdGVyLnVuc2hpZnQobWlkZGxld2FyZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBBamF4ZXIjYmVmb3JlXG4gICAqIEBwdWJsaWNcbiAgICogQHBhcmFtIHtBamF4ZXJCZWZvcmVNaWRkbGV3YXJlfEFqYXhlckVycm9yQmVmb3JlTWlkZGxld2FyZX0gbWlkZGxld2FyZSAtIE1pZGRsZXdhcmUgdG8gYWRkLlxuICAgKiBAcGFyYW0ge0Jvb2xlYW58Kn0gW2JlZm9yZUFsbCA9IHRydWVdIC0gQm9vbGVhbiBwYXJhbWV0ZXIgd2hlcmUgdG8gcHV0IHRoZSBtaWRkbGV3YXJlLlxuICAgKiBUcnV0aHkgcGFyYW1ldGVyIHN0YW5kcyBmb3IgXCJ0byB0aGUgYmVnaW5uaW5nXCIgYW5kIGZhbHNleSBmb3IgXCJ0byB0aGUgZW5kXCIuXG4gICAqIEByZXR1cm5zIHtBamF4ZXJ9IFJldHVybnMgdGhpcy5cbiAgICogQGRlc2NyaXB0aW9uIE1pZGRsZXdhcmUgdGhhdCBpcyBjYWxsZWQgYmVmb3JlIHRoZSByZXF1ZXN0LlxuICAgKiBJZiB0aGUgbWlkZGxld2FyZSBoYXMgMiBvciBsZXNzIGFyZ3VtZW50cyBpdCdzIHRyZWF0ZWQgYXMgc3VjY2VzcyBtaWRkbGV3YXJlIG90aGVyd2lzZSBhcyBhbiBlcnJvciBvbmUuXG4gICAqIElmIHRoZSBtaWRkbGV3YXJlIHJldHVybnMgYSBwcm9taXNlIGl0IGJlY29tZXMgYSBwYXJ0IG9mIHRoZSBtaWRkbGV3YXJlIGNoYWluLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBjb25zdCBhamF4ZXIgPSBuZXcgQWpheGVyKClcbiAgICogICAuYmVmb3JlKChlcnIsIHJlcSkgPT4ge1xuICAgKiAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICpcbiAgICogICAgIHRocm93IGVycjtcbiAgICogICB9KVxuICAgKiAgIC5iZWZvcmUoKHJlcSkgPT4ge1xuICAgKiAgICAgaWYgKHJlcS51cmwgPT09ICcvdmVyeUxvbmdSZXF1ZXN0Jykge1xuICAgKiAgICAgICByZXEudGltZW91dCA9IDMwMDAwO1xuICAgKiAgICAgfVxuICAgKiAgIH0pO1xuICAgKi9cbiAgYmVmb3JlKG1pZGRsZXdhcmUsIGJlZm9yZUFsbCA9IHRydWUpIHtcbiAgICBjb25zdCB7IGJlZm9yZSB9ID0gdGhpcy4kJDtcblxuICAgIGlmIChiZWZvcmVBbGwpIHtcbiAgICAgIGJlZm9yZS51bnNoaWZ0KG1pZGRsZXdhcmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBiZWZvcmUucHVzaChtaWRkbGV3YXJlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIEFqYXhlciNjb25maWdcbiAgICogQHB1YmxpY1xuICAgKiBAcGFyYW0ge1N0cmluZ3xBamF4ZXJDb25maWd8QWpheGVyQ29uZmlnRnVuY3Rpb259IFtwcm9wZXJ0eV0gLSBJZiBpdCdzIGEgZnVuY3Rpb25cbiAgICogaXQncyBjYWxsZWQgd2l0aCB0aGUgZmV0Y2ggY29uZmlnIGFyZ3VtZW50LCBpZiBpdCdzIGEgc3RyaW5nIHRoZSB2YWx1ZSBhcmd1bWVudFxuICAgKiBpcyB1c2VkIGZvciBhc3NpZ25pbmcgdGhpcyBwcm9wZXJ0eSB0byB0aGUgZmV0Y2ggY29uZmlnXG4gICAqIG90aGVyd2lzZSBpdCdzIGFzc2lnbmVkIHRvIHRoZSBmZXRjaCBjb25maWcuXG4gICAqIEBwYXJhbSB7Kn0gW3ZhbHVlXSAtIFNlZSB0aGUgcHJvcGVydHkgYXJndW1lbnQuXG4gICAqIEByZXR1cm5zIHtBamF4ZXJ8QWpheGVyQ29uZmlnfSBJZiB0aGUgYXJndW1lbnQgaXMgcHJlc2VudCB0aGlzIGlzIHJldHVybmVkIG90aGVyd2lzZSB0aGUgZmV0Y2ggY29uZmlnIGlzIHJldHVybmVkLlxuICAgKiBAZGVzY3JpcHRpb24gTWV0aG9kIGZvciBnZXR0aW5nIGFuZCBzZXR0aW5nIGNvbmZpZy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogY29uc3QgYWpheGVyID0gbmV3IEFqYXhlcigpO1xuICAgKlxuICAgKiBhamF4ZXIuY29uZmlnKHsgYmFzZVVSTDogNTAwMCB9KTtcbiAgICogYWpheGVyLmNvbmZpZygpLnRpbWVvdXQ7IC8vIDUwMDBcbiAgICpcbiAgICogYWpheGVyLmNvbmZpZygoY29uZmlnKSA9PiB7XG4gICAqICAgY29uZmlnLmJhc2VVUkwgKz0gJy9hcGknO1xuICAgKiB9KTtcbiAgICovXG4gIGNvbmZpZyhwcm9wZXJ0eSwgdmFsdWUpIHtcbiAgICBjb25zdCBjb25maWcgPSB0aGlzLiQkO1xuXG4gICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gY29uZmlnO1xuICAgIH1cblxuICAgIGlmIChpc0Z1bmN0aW9uKHByb3BlcnR5KSkge1xuICAgICAgcHJvcGVydHkoY29uZmlnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMikge1xuICAgICAgICBwcm9wZXJ0eSA9IHsgW3Byb3BlcnR5XTogdmFsdWUgfTtcbiAgICAgIH1cblxuICAgICAgZGVlcEFzc2lnbihjb25maWcsIHByb3BlcnR5KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIEFqYXhlciNkZWxldGVcbiAgICogQHB1YmxpY1xuICAgKiBAcGFyYW0ge1N0cmluZ30gW3VybF0gLSBTZWUge0BsaW5rIEFqYXhlciNyZXF1ZXN0fS5cbiAgICogQHBhcmFtIHtBamF4ZXJDb25maWd9IFtjb25maWddIC0gU2VlIHtAbGluayBBamF4ZXIjcmVxdWVzdH0uXG4gICAqIEByZXR1cm5zIHtQcm9taXNlLjxBamF4ZXJSZXNwb25zZSwgRXJyb3I+fSBTZWUge0BsaW5rIEFqYXhlciNyZXF1ZXN0fS5cbiAgICogQGRlc2NyaXB0aW9uIFNob3J0aGFuZCBmb3IgI3JlcXVlc3QgZm9yIGRlbGV0ZSByZXF1ZXN0cy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYWpheGVyLmRlbGV0ZSgnL2RhdGEnKS50aGVuKChyZXMpID0+IHtcbiAgICogICBjb25zb2xlLmxvZyhyZXMpO1xuICAgKiB9KTtcbiAgICovXG4gIGRlbGV0ZSh1cmwsIGNvbmZpZyA9IHt9KSB7XG4gICAgaWYgKCFpc1N0cmluZyh1cmwpKSB7XG4gICAgICBjb25maWcgPSB1cmw7XG4gICAgICB1cmwgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdCh1cmwsIGFzc2lnbih7IG1ldGhvZDogJ2RlbGV0ZScgfSwgY29uZmlnKSk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBBamF4ZXIjZ2V0XG4gICAqIEBwdWJsaWNcbiAgICogQHBhcmFtIHtTdHJpbmd9IFt1cmxdIC0gU2VlIHtAbGluayBBamF4ZXIjcmVxdWVzdH0uXG4gICAqIEBwYXJhbSB7QWpheGVyQ29uZmlnfSBbY29uZmlnXSAtIFNlZSB7QGxpbmsgQWpheGVyI3JlcXVlc3R9LlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZS48QWpheGVyUmVzcG9uc2UsIEVycm9yPn0gU2VlIHtAbGluayBBamF4ZXIjcmVxdWVzdH0uXG4gICAqIEBkZXNjcmlwdGlvbiBTaG9ydGhhbmQgZm9yICNyZXF1ZXN0IGZvciBnZXQgcmVxdWVzdHMuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGFqYXhlci5nZXQoJy9kYXRhJykudGhlbigocmVzKSA9PiB7XG4gICAqICAgY29uc29sZS5sb2cocmVzKTtcbiAgICogfSk7XG4gICAqL1xuICBnZXQodXJsLCBjb25maWcgPSB7fSkge1xuICAgIGlmICghaXNTdHJpbmcodXJsKSkge1xuICAgICAgY29uZmlnID0gdXJsO1xuICAgICAgdXJsID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnJlcXVlc3QodXJsLCBhc3NpZ24oeyBtZXRob2Q6ICdnZXQnIH0sIGNvbmZpZykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgQWpheGVyI2hlYWRcbiAgICogQHB1YmxpY1xuICAgKiBAcGFyYW0ge1N0cmluZ30gW3VybF0gLSBTZWUge0BsaW5rIEFqYXhlciNyZXF1ZXN0fS5cbiAgICogQHBhcmFtIHtBamF4ZXJDb25maWd9IFtjb25maWddIC0gU2VlIHtAbGluayBBamF4ZXIjcmVxdWVzdH0uXG4gICAqIEByZXR1cm5zIHtQcm9taXNlLjxBamF4ZXJSZXNwb25zZSwgRXJyb3I+fSBTZWUge0BsaW5rIEFqYXhlciNyZXF1ZXN0fS5cbiAgICogQGRlc2NyaXB0aW9uIFNob3J0aGFuZCBmb3IgI3JlcXVlc3QgZm9yIGhlYWQgcmVxdWVzdHMuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGFqYXhlci5oZWFkKCcvZGF0YScpLnRoZW4oKHJlcykgPT4ge1xuICAgKiAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAqIH0pO1xuICAgKi9cbiAgaGVhZCh1cmwsIGNvbmZpZyA9IHt9KSB7XG4gICAgaWYgKCFpc1N0cmluZyh1cmwpKSB7XG4gICAgICBjb25maWcgPSB1cmw7XG4gICAgICB1cmwgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdCh1cmwsIGFzc2lnbih7IG1ldGhvZDogJ2hlYWQnIH0sIGNvbmZpZykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgQWpheGVyI2hlYWRlcnNcbiAgICogQHB1YmxpY1xuICAgKiBAcGFyYW0ge1N0cmluZ3xPYmplY3QuPFN0cmluZywgU3RyaW5nPn0gaGVhZGVyIC0gQSBoZWFkZXIgc3RyaW5nIG9yIGFuIG9iamVjdCBvZiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcbiAgICogeyBbaGVhZGVyXTogW3ZhbHVlMSwgdmFsdWUyLCAuLi5dIH0uXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBbdmFsdWVdIC0gSGVhZGVyIHZhbHVlLiBJZiB0aGUgZmlyc3QgYXJndW1lbnQgaXMgYSBzdHJpbmdcbiAgICogdGhpcyBoYXMgdG8gYmUgYSBoZWFkZXIgdmFsdWUuXG4gICAqIEByZXR1cm5zIHtBamF4ZXJ9IFJldHVybnMgdGhpcy5cbiAgICogQGRlc2NyaXB0aW9uIE1ldGhvZCBmb3Igc2V0dGluZyByZXF1ZXN0IGhlYWRlcnMuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGFqYXhlclxuICAgKiAgIC5oZWFkZXJzKCdNeS1IZWFkZXInLCAnVmFsdWUnKVxuICAgKiAgIC5oZWFkZXJzKHtcbiAgICogICAgICdNeS1Bbm90aGVyLUhlYWRlcic6ICdWYWx1ZTInXG4gICAqICAgfSk7XG4gICAqL1xuICBoZWFkZXJzKGhlYWRlciwgdmFsdWUpIHtcbiAgICBjb25zdCB7IGhlYWRlcnMgfSA9IHRoaXMuJCQ7XG5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+PSAyKSB7XG4gICAgICBoZWFkZXIgPSB7IFtoZWFkZXJdOiB2YWx1ZSB9O1xuICAgIH1cblxuICAgIGl0ZXJhdGUoaGVhZGVyLCAodmFsdWUsIGhlYWRlcikgPT4ge1xuICAgICAgaGVhZGVyc1toZWFkZXJdID0gdmFsdWU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIEFqYXhlciNpbnN0YW5jZVxuICAgKiBAcHVibGljXG4gICAqIEBwYXJhbSB7QWpheGVyQ29uZmlnfSBbY29uZmlnXSAtIE5ldyBjb25maWcgaWYgbmVlZGVkLlxuICAgKiBAcmV0dXJucyB7QWpheGVyfSBOZXcgaW5zdGFuY2Ugb2YgQWpheGVyLlxuICAgKiBAZGVzY3JpcHRpb24gTWV0aG9kIGZvciBjcmVhdGluZyBuZXcgYWpheGVyIGluc3RhbmNlcyBiYXNlZCBvbiBhbHJlYWR5IGV4aXN0ZW50LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBjb25zdCBtYWluQWpheGVyID0gbmV3IEFqYXhlcih7XG4gICAqICAgYmFzZVVSTDogJy8vb3RoZXIuZG9tYWluLmNvbS9hcGknLFxuICAgKiAgIHdpdGhDcmVkZW50aWFsczogdHJ1ZVxuICAgKiB9KTtcbiAgICpcbiAgICogY29uc3QgbG9uZ0FqYXhlciA9IG1haW5BamF4ZXIuaW5zdGFuY2Uoe1xuICAgKiAgIHRpbWVvdXQ6IDEwMDAwXG4gICAqIH0pO1xuICAgKi9cbiAgaW5zdGFuY2UoY29uZmlnID0ge30pIHtcbiAgICBjb25zdCBkYXRhQ29uZmlnID0gaGFzT3duKGNvbmZpZywgJ2RhdGEnKVxuICAgICAgPyB7IGRhdGE6IGNvbmZpZy5kYXRhIH1cbiAgICAgIDoge307XG5cbiAgICBkZWxldGUgY29uZmlnLmRhdGE7XG5cbiAgICBjb25zdCBjb25mID0gYXNzaWduKFxuICAgICAgZGVlcEFzc2lnbih7fSwgdGhpcy4kJCwgY29uZmlnKSxcbiAgICAgIGRhdGFDb25maWdcbiAgICApO1xuXG4gICAgcmV0dXJuIG5ldyBBamF4ZXIoY29uZik7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBBamF4ZXIjcGF0Y2hcbiAgICogQHB1YmxpY1xuICAgKiBAcGFyYW0ge1N0cmluZ30gW3VybF0gLSBTZWUge0BsaW5rIEFqYXhlciNyZXF1ZXN0fS5cbiAgICogQHBhcmFtIHsqfSBbZGF0YV0gLSBBZGRpdGlvbmFsIHBhcmFtZXRlciBmb3IgdXBsb2FkaW5nIGRhdGEuXG4gICAqIEBwYXJhbSB7QWpheGVyQ29uZmlnfSBbY29uZmlnXSAtIFNlZSB7QGxpbmsgQWpheGVyI3JlcXVlc3R9LlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZS48QWpheGVyUmVzcG9uc2UsIEVycm9yPn0gU2VlIHtAbGluayBBamF4ZXIjcmVxdWVzdH0uXG4gICAqIEBkZXNjcmlwdGlvbiBTaG9ydGhhbmQgZm9yICNyZXF1ZXN0IGZvciBoZWFkIHJlcXVlc3RzLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBhamF4ZXIucGF0Y2goJy9kYXRhJywgeyB1c2VyOiAnSm9obicgfSkudGhlbigocmVzKSA9PiB7XG4gICAqICAgY29uc29sZS5sb2cocmVzKTtcbiAgICogfSk7XG4gICAqL1xuICBwYXRjaCh1cmwsIGRhdGEgPSB7fSwgY29uZmlnID0ge30pIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCAmJiAhaXNTdHJpbmcodXJsKSkge1xuICAgICAgY29uZmlnID0gZGF0YTtcbiAgICAgIGRhdGEgPSB1cmw7XG4gICAgICB1cmwgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdCh1cmwsIGFzc2lnbih7IG1ldGhvZDogJ3BhdGNoJywgZGF0YSB9LCBjb25maWcpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIEFqYXhlciNwb3N0XG4gICAqIEBwdWJsaWNcbiAgICogQHBhcmFtIHtTdHJpbmd9IFt1cmxdIC0gU2VlIHtAbGluayBBamF4ZXIjcmVxdWVzdH0uXG4gICAqIEBwYXJhbSB7Kn0gW2RhdGFdIC0gQWRkaXRpb25hbCBwYXJhbWV0ZXIgZm9yIHVwbG9hZGluZyBkYXRhLlxuICAgKiBAcGFyYW0ge0FqYXhlckNvbmZpZ30gW2NvbmZpZ10gLSBTZWUge0BsaW5rIEFqYXhlciNyZXF1ZXN0fS5cbiAgICogQHJldHVybnMge1Byb21pc2UuPEFqYXhlclJlc3BvbnNlLCBFcnJvcj59IFNlZSB7QGxpbmsgQWpheGVyI3JlcXVlc3R9LlxuICAgKiBAZGVzY3JpcHRpb24gU2hvcnRoYW5kIGZvciAjcmVxdWVzdCBmb3IgaGVhZCByZXF1ZXN0cy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYWpheGVyLnBvc3QoJy9kYXRhJywgeyB1c2VyOiAnSm9obicgfSkudGhlbigocmVzKSA9PiB7XG4gICAqICAgY29uc29sZS5sb2cocmVzKTtcbiAgICogfSk7XG4gICAqL1xuICBwb3N0KHVybCwgZGF0YSA9IHt9LCBjb25maWcgPSB7fSkge1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoICYmICFpc1N0cmluZyh1cmwpKSB7XG4gICAgICBjb25maWcgPSBkYXRhO1xuICAgICAgZGF0YSA9IHVybDtcbiAgICAgIHVybCA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KHVybCwgYXNzaWduKHsgbWV0aG9kOiAncG9zdCcsIGRhdGEgfSwgY29uZmlnKSk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBBamF4ZXIjcHV0XG4gICAqIEBwdWJsaWNcbiAgICogQHBhcmFtIHtTdHJpbmd9IFt1cmxdIC0gU2VlIHtAbGluayBBamF4ZXIjcmVxdWVzdH0uXG4gICAqIEBwYXJhbSB7Kn0gW2RhdGFdIC0gQWRkaXRpb25hbCBwYXJhbWV0ZXIgZm9yIHVwbG9hZGluZyBkYXRhLlxuICAgKiBAcGFyYW0ge0FqYXhlckNvbmZpZ30gW2NvbmZpZ10gLSBTZWUge0BsaW5rIEFqYXhlciNyZXF1ZXN0fS5cbiAgICogQHJldHVybnMge1Byb21pc2UuPEFqYXhlclJlc3BvbnNlLCBFcnJvcj59IFNlZSB7QGxpbmsgQWpheGVyI3JlcXVlc3R9LlxuICAgKiBAZGVzY3JpcHRpb24gU2hvcnRoYW5kIGZvciAjcmVxdWVzdCBmb3IgaGVhZCByZXF1ZXN0cy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYWpheGVyLnB1dCgnL2RhdGEnLCB7IHVzZXI6ICdKb2huJyB9KS50aGVuKChyZXMpID0+IHtcbiAgICogICBjb25zb2xlLmxvZyhyZXMpO1xuICAgKiB9KTtcbiAgICovXG4gIHB1dCh1cmwsIGRhdGEgPSB7fSwgY29uZmlnID0ge30pIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCAmJiAhaXNTdHJpbmcodXJsKSkge1xuICAgICAgY29uZmlnID0gZGF0YTtcbiAgICAgIGRhdGEgPSB1cmw7XG4gICAgICB1cmwgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdCh1cmwsIGFzc2lnbih7IG1ldGhvZDogJ3B1dCcsIGRhdGEgfSwgY29uZmlnKSk7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBBamF4ZXIjcmVxdWVzdFxuICAgKiBAcHVibGljXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBbdXJsXSAtIFVSTCBmb3IgdGhlIHJlcXVlc3QuXG4gICAqIEBwYXJhbSB7QWpheGVyQ29uZmlnfSBbY29uZmlnXSAtIEFkZGl0aW9uYWwgY29uZmlnIGZvciB0aGlzIHBhcnRpY3VsYXIgcmVxdWVzdC5cbiAgICogQHJldHVybnMge1Byb21pc2UuPEFqYXhlclJlc3BvbnNlLCBFcnJvcj59IFByb21pc2UgdGhhdCBpcyByZXNvbHZlZCB3aXRoIHRoZSByZXF1ZXN0IHJlc3BvbnNlLlxuICAgKiBAZGVzY3JpcHRpb24gTWFpbiBmdW5jdGlvbiBmb3IgbWFraW5nIHJlcXVlc3RzLiBBbGwgcmVxdWVzdCBtZXRob2RzIGNhbGwgdGhpcyBtZXRob2RcbiAgICogaW5jbHVkaW5nIHRoZSBmZXRjaCBpbnN0YW5jZSBpdHNlbGYuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGFqYXhlci5yZXF1ZXN0KCcvZGF0YScsIHsgdGltZW91dDogMTAwMCB9KS50aGVuKChyZXMpID0+IHtcbiAgICogICBjb25zb2xlLmxvZyhyZXMpO1xuICAgKiB9KTtcbiAgICpcbiAgICogYWpheGVyLnJlcXVlc3QoeyB0aW1lb3V0OiAxMDAwIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgKiAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAqIH0pO1xuICAgKlxuICAgKiBhamF4ZXIucmVxdWVzdCgpLnRoZW4oKHJlcykgPT4ge1xuICAgKiAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAqIH0pO1xuICAgKi9cbiAgcmVxdWVzdCh1cmwsIGNvbmZpZyA9IHt9KSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgIWlzU3RyaW5nKHVybCkpIHtcbiAgICAgIGNvbmZpZyA9IHVybDtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhQ29uZmlnID0gaGFzT3duKGNvbmZpZywgJ2RhdGEnKVxuICAgICAgPyB7IGRhdGE6IGNvbmZpZy5kYXRhIH1cbiAgICAgIDoge307XG4gICAgY29uc3QgdXJsQ29uZmlnID0gaXNTdHJpbmcodXJsKVxuICAgICAgPyB7IHVybCB9XG4gICAgICA6IHt9O1xuXG4gICAgZGVsZXRlIGNvbmZpZy5kYXRhO1xuXG4gICAgY29uc3QgY29uZiA9IGFzc2lnbihcbiAgICAgIGRlZXBBc3NpZ24oXG4gICAgICAgIGRlZXBDbG9uZSh0aGlzLiQkKSxcbiAgICAgICAgdXJsQ29uZmlnLFxuICAgICAgICBjb25maWdcbiAgICAgICksXG4gICAgICBkYXRhQ29uZmlnXG4gICAgKTtcblxuICAgIGxldCB4aHI7XG4gICAgbGV0IHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTtcblxuICAgIGl0ZXJhdGUoY29uZi5iZWZvcmUsIChtaWRkbGV3YXJlKSA9PiB7XG4gICAgICBwcm9taXNlID0gcHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgICAgaWYgKG1pZGRsZXdhcmUubGVuZ3RoID49IDIpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgICByZXNvbHZlKG1pZGRsZXdhcmUoY29uZikpO1xuICAgICAgICB9KTtcbiAgICAgIH0sIChlcnIpID0+IHtcbiAgICAgICAgaWYgKG1pZGRsZXdhcmUubGVuZ3RoIDwgMikge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgcmVzb2x2ZShtaWRkbGV3YXJlKGVyciwgY29uZikpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcHJvbWlzZSA9IHByb21pc2UudGhlbigoKSA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGFmdGVyLFxuICAgICAgICBhdXRoOiB7XG4gICAgICAgICAgdXNlcm5hbWUsXG4gICAgICAgICAgcGFzc3dvcmRcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YSxcbiAgICAgICAgaGVhZGVycyxcbiAgICAgICAgbWV0aG9kLFxuICAgICAgICBvbnByb2dyZXNzLFxuICAgICAgICByZXNwb25zZVR5cGUsXG4gICAgICAgIHRpbWVvdXQsXG4gICAgICAgIHVybCxcbiAgICAgICAgd2l0aENyZWRlbnRpYWxzXG4gICAgICB9ID0gY29uZjtcblxuICAgICAgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsLCB0cnVlLCB1c2VybmFtZSwgcGFzc3dvcmQpO1xuXG4gICAgICBpdGVyYXRlKGhlYWRlcnMsICh2YWx1ZSwgaGVhZGVyKSA9PiB7XG4gICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKGhlYWRlciwgdmFsdWUpO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChvbnByb2dyZXNzKSB7XG4gICAgICAgIGlmICh1cGxvYWRNZXRob2RzLmluZGV4T2YobWV0aG9kKSA9PT0gLTEpIHtcbiAgICAgICAgICB4aHIub25wcm9ncmVzcyA9IG9ucHJvZ3Jlc3M7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgeGhyLnVwbG9hZC5vbnByb2dyZXNzID0gb25wcm9ncmVzcztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB4aHIub25hYm9ydCA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ1JlcXVlc3Qgd2FzIGFib3J0ZWQnKTtcblxuICAgICAgICBlcnJvci50eXBlID0gJ0FCT1JUX0VSUk9SJztcblxuICAgICAgICByZWplY3QoZXJyb3IpO1xuXG4gICAgICAgIHhociA9IG51bGw7XG4gICAgICB9O1xuXG4gICAgICB4aHIub25lcnJvciA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKTtcblxuICAgICAgICBlcnJvci50eXBlID0gJ05FVFdPUktfRVJST1InO1xuXG4gICAgICAgIHJlamVjdChlcnJvcik7XG5cbiAgICAgICAgeGhyID0gbnVsbDtcbiAgICAgIH07XG5cbiAgICAgIHhoci5vbnRpbWVvdXQgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdSZXF1ZXN0IHRpbWUgZXhjZWVkZWQnKTtcblxuICAgICAgICBlcnJvci50eXBlID0gJ1RJTUVPVVRfRVJST1InO1xuXG4gICAgICAgIHJlamVjdChlcnJvcik7XG5cbiAgICAgICAgeGhyID0gbnVsbDtcbiAgICAgIH07XG5cbiAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgIGlmICgheGhyIHx8ICF4aHIuc3RhdHVzIHx8IHhoci5yZWFkeVN0YXRlICE9PSA0KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB7XG4gICAgICAgICAgY29uZmlnOiBjb25mLFxuICAgICAgICAgIGRhdGE6ICFyZXNwb25zZVR5cGUgfHwgcmVzcG9uc2VUeXBlID09PSAndGV4dCcgPyB4aHIucmVzcG9uc2VUZXh0IDogeGhyLnJlc3BvbnNlLFxuICAgICAgICAgIGhlYWRlcnM6IHBhcnNlSGVhZGVycyh4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpLFxuICAgICAgICAgIHN0YXR1czogeGhyLnN0YXR1cyA9PT0gMTIyMyA/IDIwNCA6IHhoci5zdGF0dXMsXG4gICAgICAgICAgc3RhdHVzVGV4dDogeGhyLnN0YXR1cyA9PT0gMTIyMyA/ICdObyBDb250ZW50JyA6IHhoci5zdGF0dXNUZXh0LFxuICAgICAgICAgIHhoclxuICAgICAgICB9O1xuXG4gICAgICAgIGxldCBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG5cbiAgICAgICAgaXRlcmF0ZShhZnRlciwgKG1pZGRsZXdhcmUpID0+IHtcbiAgICAgICAgICBwcm9taXNlID0gcHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGlmIChtaWRkbGV3YXJlLmxlbmd0aCA+PSAyKSB7XG4gICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICAgIHJlc29sdmUobWlkZGxld2FyZShyZXNwb25zZSkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSwgKGVycikgPT4ge1xuICAgICAgICAgICAgaWYgKG1pZGRsZXdhcmUubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICAgIHJlc29sdmUobWlkZGxld2FyZShlcnIsIHJlc3BvbnNlKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmVzb2x2ZShwcm9taXNlXG4gICAgICAgICAgLnRoZW4oKCkgPT4gcmVzcG9uc2UpXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGVyci5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgfTtcblxuICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9IHJlc3BvbnNlVHlwZTtcbiAgICAgIHhoci50aW1lb3V0ID0gK3RpbWVvdXQgfHwgMDtcbiAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSAhIXdpdGhDcmVkZW50aWFscztcblxuICAgICAgeGhyLnNlbmQoZGF0YSk7XG4gICAgfSkpO1xuXG4gICAgcHJvbWlzZS5hYm9ydCA9IGZ1bmN0aW9uIGFib3J0KCkge1xuICAgICAgaWYgKHhocikge1xuICAgICAgICB4aHIuYWJvcnQoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIHJldHVybiBwcm9taXNlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGZldGNoQmVmb3JlTWlkZGxld2FyZShjb25maWcpIHtcbiAgY29uc3Qge1xuICAgIGJhc2VVUkwsXG4gICAgZGF0YSxcbiAgICBoZWFkZXJzLFxuICAgIG1ldGhvZCxcbiAgICBwYXJhbXMsXG4gICAgcXVlcnksXG4gICAgdXJsXG4gIH0gPSBjb25maWc7XG4gIGNvbnN0IE1FVEhPRCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpO1xuXG4gIGNvbmZpZy5tZXRob2QgPSBNRVRIT0Q7XG4gIGNvbmZpZy51cmwgPSBjb25zdHJ1Y3RVUkwoYmFzZVVSTCwgdXJsLCBwYXJhbXMsIHF1ZXJ5KTtcbiAgY29uZmlnLmRhdGEgPSB0cmFuc2Zvcm1EYXRhKGRhdGEsIE1FVEhPRCwgaGVhZGVycyk7XG59XG5cbi8qKlxuICogQGNvbnN0IHtBamF4ZXJ9IGZldGNoXG4gKiBAdHlwZSB7QWpheGVyfVxuICogQHB1YmxpY1xuICogQGRlc2NyaXB0aW9uIEVtcHR5IGluc3RhbmNlIG9mIEFqYXhlci5cbiAqL1xuY29uc3QgZmV0Y2ggPSBuZXcgQWpheGVyKCk7XG5cbmV4cG9ydCBkZWZhdWx0IEFqYXhlcjtcbmV4cG9ydCB7IEFqYXhlciwgUHJvbWlzZSwgZmV0Y2ggfTtcbiIsIi8qIGVzbGludCBuby1uZXN0ZWQtdGVybmFyeTogMCAqL1xuLyogZXNsaW50IG5vLW5lZ2F0ZWQtY29uZGl0aW9uOiAwICovXG5leHBvcnQgZGVmYXVsdCB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9O1xuIiwiaW1wb3J0IHsgaXNGdW5jdGlvbiB9IGZyb20gJy4vdXRpbHMnO1xuXG4vKipcbiAqIEBjYWxsYmFjayBvbkZ1bGZpbGxlZE9yUmVqZWN0ZWRcbiAqIEBwdWJsaWNcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgLSBQcm9taXNlIHZhbHVlLlxuICogQHBhcmFtIHtCb29sZWFufSBzdWNjZXNzIC0gSWYgdGhlIHByZXZpb3VzIHByb21pc2UgaXMgZnVsZmlsbGVkIGl0J3MgdHJ1ZSBhbmQgZmFsc2UgaWYgcmVqZWN0ZWQuXG4gKi9cblxuLyoqXG4gKiBAY2FsbGJhY2sgb25SZWplY3RlZFxuICogQHB1YmxpY1xuICogQHBhcmFtIHtFcnJvcnwqfSBlcnIgLSBQcm9taXNlIGVycm9yLlxuICovXG5cbi8qKlxuICogQGNhbGxiYWNrIG9uRnVsZmlsbGVkXG4gKiBAcHVibGljXG4gKiBAcGFyYW0geyp9IHZhbHVlIC0gUHJvbWlzZSB2YWx1ZS5cbiAqL1xuXG5jb25zdCBzZWNyZXQgPSB7fTtcbmNvbnN0IGl0ZXJhdG9yID0gZ2xvYmFsLlN5bWJvbFxuICA/IFN5bWJvbC5pdGVyYXRvclxuICA6IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpO1xuXG4vKipcbiAqIEBjbGFzcyBQcm9taXNlXG4gKiBAcHVibGljXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBleGVjdXRvciAtIEZ1bmN0aW9uIHRoYXQgdGFrZXMgdHdvIGFyZ3VtZW50czogcmVzb2x2ZSBhbmQgcmVqZWN0IGZ1bmN0aW9ucy5cbiAqIENhbGwgdGhlIHJlc29sdmUgZnVuY3Rpb24gd2hlbiB5b3UgbmVlZCB0byBmdWxmaWxsIHRoZSBwcm9taXNlIGFuZCBjYWxsIHRoZSByZWplY3Qgb25lXG4gKiB3aGVuIHlvdSBuZWVkIHRvIHJlamVjdCBpdC5cbiAqIEByZXR1cm5zIHtQcm9taXNlfSBJbnN0YW5jZSBvZiBQcm9taXNlLlxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9Qcm9taXNlXG4gKiBAZGVzY3JpcHRpb24gQ2xhc3Mgd2l0aCBhbG1vc3QgaWRlbnRpY2FsIEFQSSB0b1xuICogW0VTNiBQcm9taXNlXXtAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9Qcm9taXNlfS5cbiAqIFRoZXJlIGlzIGEgY291cGxlIGRpZmZlcmVuY2VzOiBzZXQgUHJvbWlzZS5vbkVycm9yIHRvIGEgZnVuY3Rpb24gd2l0aCB3aGljaCB5b3Ugd2FudCB0b1xuICogc3Vic2NyaWJlIHRvIGEgcHJvbWlzZSBlcnJvciBhbmQgc2V0IFByb21pc2Uub25VbmhhbmRsZWRSZWplY3Rpb24gdG8gYSBmdW5jdGlvbiB3aXRoIHdoaWNoXG4gKiB5b3Ugd2FudCB0byBzdWJzY3JpYmUgdG8gYW4gdW5oYW5kbGVkIGVycm9yXG4gKiAoZGVmYXVsdHMgdG8gY29uc29sZS5lcnJvci5iaW5kKGNvbnNvbGUsICclcyAlbycsICdVbmNhdWdodCAoaW4gcHJvbWlzZSknKSkuXG4gKi9cbmNsYXNzIFByb21pc2Uge1xuICBjb25zdHJ1Y3RvcihleGVjdXRvcikge1xuICAgIGlmICghaXNGdW5jdGlvbihleGVjdXRvcikpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYFByb21pc2UgcmVzb2x2ZXIgJHsge30udG9TdHJpbmcuY2FsbChleGVjdXRvcikgfSBpcyBub3QgYSBmdW5jdGlvbmApO1xuICAgIH1cblxuICAgIGxldCBoaWRkZW5TdGF0dXM7XG4gICAgbGV0IGhpZGRlblZhbHVlO1xuXG4gICAgY29uc3RcdG9uRnVsZmlsbCA9IFtdO1xuICAgIGNvbnN0IG9uUmVqZWN0ID0gW107XG4gICAgY29uc3QgcmVhbFByb21pc2UgPSB0aGlzO1xuICAgIGNvbnN0IGhpZGRlblByb21pc2UgPSB7XG4gICAgICBoYW5kbGVkOiBmYWxzZSxcbiAgICAgIGdldCBzdGF0dXMoKSB7XG4gICAgICAgIHJldHVybiBoaWRkZW5TdGF0dXM7XG4gICAgICB9LFxuICAgICAgc2V0IHN0YXR1cyh2YWx1ZSkge1xuICAgICAgICBoaWRkZW5TdGF0dXMgPSB2YWx1ZTtcbiAgICAgICAgcmVhbFByb21pc2Uuc3RhdHVzID0gdmFsdWU7XG4gICAgICB9LFxuICAgICAgZ2V0IHZhbHVlKCkge1xuICAgICAgICByZXR1cm4gaGlkZGVuVmFsdWU7XG4gICAgICB9LFxuICAgICAgc2V0IHZhbHVlKHZhbCkge1xuICAgICAgICBoaWRkZW5WYWx1ZSA9IHZhbDtcbiAgICAgICAgcmVhbFByb21pc2UudmFsdWUgPSB2YWw7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGhpZGRlblByb21pc2Uuc3RhdHVzID0gJ3BlbmRpbmcnO1xuICAgIGhpZGRlblByb21pc2UudmFsdWUgPSB1bmRlZmluZWQ7XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLiQkID0ge30sIHtcbiAgICAgIGhhbmRsZWQ6IHtcbiAgICAgICAgZ2V0KCkge1xuICAgICAgICAgIHJldHVybiBoaWRkZW5Qcm9taXNlLmhhbmRsZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldChrZXkpIHtcbiAgICAgICAgICBpZiAoa2V5ID09PSBzZWNyZXQpIHtcbiAgICAgICAgICAgIGhpZGRlblByb21pc2UuaGFuZGxlZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgaGFuZGxlOiB7XG4gICAgICAgIHZhbHVlKHN0YXR1cywgZiwgcmVzb2x2ZSwgcmVqZWN0LCBrZXkpIHtcbiAgICAgICAgICBpZiAoa2V5ID09PSBzZWNyZXQpIHtcbiAgICAgICAgICAgIGxldCBwcm94eSA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGYpKSB7XG4gICAgICAgICAgICAgIHByb3h5ID0gKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUoZih2YWx1ZSkpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc3RhdHVzID09PSAncmVzb2x2ZScpIHtcbiAgICAgICAgICAgICAgb25GdWxmaWxsLnB1c2gocHJveHkgfHwgKCh2YWx1ZSkgPT4gcmVzb2x2ZSh2YWx1ZSkpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09PSAncmVqZWN0Jykge1xuICAgICAgICAgICAgICBvblJlamVjdC5wdXNoKHByb3h5IHx8ICgoZXJyKSA9PiByZWplY3QoZXJyKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHN0YXR1czoge1xuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgcmV0dXJuIGhpZGRlblByb21pc2Uuc3RhdHVzO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgdmFsdWU6IHtcbiAgICAgICAgZ2V0KCkge1xuICAgICAgICAgIHJldHVybiBoaWRkZW5Qcm9taXNlLnZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgZXhlY3V0b3IocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJlamVjdChlcnIpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlamVjdChlcnIpIHtcbiAgICAgIGlmIChoaWRkZW5Qcm9taXNlLnN0YXR1cyA9PT0gJ3BlbmRpbmcnKSB7XG4gICAgICAgIGhpZGRlblByb21pc2Uuc3RhdHVzID0gJ3JlamVjdGVkJztcbiAgICAgICAgaGlkZGVuUHJvbWlzZS52YWx1ZSA9IGVycjtcblxuICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gb25SZWplY3QubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBoaWRkZW5Qcm9taXNlLmhhbmRsZWQgPSB0cnVlO1xuXG4gICAgICAgICAgb25SZWplY3RbaV0oZXJyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBvblVuaGFuZGxlZFJlamVjdGlvbixcbiAgICAgICAgICBvbkVycm9yXG4gICAgICAgIH0gPSBQcm9taXNlO1xuXG4gICAgICAgIGlmIChpc0Z1bmN0aW9uKG9uRXJyb3IpKSB7XG4gICAgICAgICAgb25FcnJvcihlcnIpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgaWYgKCFoaWRkZW5Qcm9taXNlLmhhbmRsZWQgJiYgaXNGdW5jdGlvbihvblVuaGFuZGxlZFJlamVjdGlvbikpIHtcbiAgICAgICAgICAgIG9uVW5oYW5kbGVkUmVqZWN0aW9uKGVycik7XG4gICAgICAgICAgfVxuICAgICAgICB9LCAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXNvbHZlKHZhbHVlKSB7XG4gICAgICBpZiAoaGlkZGVuUHJvbWlzZS5zdGF0dXMgPT09ICdwZW5kaW5nJykge1xuICAgICAgICBpZiAodmFsdWUgJiYgaXNGdW5jdGlvbih2YWx1ZS50aGVuKSkge1xuICAgICAgICAgIHJldHVybiB2YWx1ZS50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgICAgICAgfSwgKGVycikgPT4ge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBoaWRkZW5Qcm9taXNlLnN0YXR1cyA9ICdmdWxmaWxsZWQnO1xuICAgICAgICBoaWRkZW5Qcm9taXNlLnZhbHVlID0gdmFsdWU7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IG9uRnVsZmlsbC5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgIGhpZGRlblByb21pc2UuaGFuZGxlZCA9IHRydWU7XG5cbiAgICAgICAgICBvbkZ1bGZpbGxbaV0odmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgUHJvbWlzZS5hbGxcbiAgICogQHBhcmFtIHsoQXJyYXl8SXRlcmFibGUpLjxQcm9taXNlfCo+fSBpdGVyYWJsZSAtIEl0ZXJhYmxlIG9iamVjdCAobGlrZSBhcnJheSkgb2YgcHJvbWlzZXNcbiAgICogb3IgYW55IHZhbHVlcy5cbiAgICogQHJldHVybnMge1Byb21pc2V9IE5ldyBpbnN0YW5jZSBvZiBQcm9taXNlLlxuICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL1Byb21pc2UvYWxsXG4gICAqL1xuICBzdGF0aWMgYWxsKGl0ZXJhYmxlKSB7XG4gICAgY29uc3QgYXJyYXkgPSBbXTtcblxuICAgIGxldCB0b1Jlc29sdmUgPSAwO1xuXG4gICAgaWYgKGl0ZXJhYmxlW2l0ZXJhdG9yXSkge1xuICAgICAgaXRlcmFibGUgPSBpdGVyYWJsZVtpdGVyYXRvcl0oKTtcblxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgbGV0IG5leHQ7XG4gICAgICAgIGxldCBpID0gMDtcblxuICAgICAgICB3aGlsZSAoIShuZXh0ID0gaXRlcmFibGUubmV4dCgpKS5kb25lKSB7XG4gICAgICAgICAgY29uc3QgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShuZXh0LnZhbHVlKTtcblxuICAgICAgICAgIHRvUmVzb2x2ZSsrO1xuXG4gICAgICAgICAgKChpKSA9PiB7XG4gICAgICAgICAgICBwcm9taXNlLnRoZW4oKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgIHRvUmVzb2x2ZS0tO1xuICAgICAgICAgICAgICBhcnJheVtpXSA9IHZhbHVlO1xuXG4gICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChuZXh0LmRvbmUgJiYgIXRvUmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgICAgcmVzb2x2ZShhcnJheSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LCAxKTtcbiAgICAgICAgICAgIH0sIHJlamVjdCk7XG4gICAgICAgICAgfSkoaSsrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoW10pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBsZW5ndGggPSBpdGVyYWJsZS5sZW5ndGg7XG5cbiAgICBpZiAoIWxlbmd0aCkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShbXSk7XG4gICAgfVxuXG4gICAgdG9SZXNvbHZlID0gbGVuZ3RoO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShpdGVyYWJsZVtpXSk7XG5cbiAgICAgICAgcHJvbWlzZS50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRvUmVzb2x2ZS0tO1xuICAgICAgICAgIGFycmF5W2ldID0gdmFsdWU7XG5cbiAgICAgICAgICBpZiAoIXRvUmVzb2x2ZSkge1xuICAgICAgICAgICAgcmVzb2x2ZShhcnJheSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCByZWplY3QpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgUHJvbWlzZS5yYWNlXG4gICAqIEBwYXJhbSB7KEFycmF5fEl0ZXJhYmxlKS48UHJvbWlzZXwqPn0gaXRlcmFibGUgLSBJdGVyYWJsZSBvYmplY3QgKGxpa2UgYXJyYXkpIG9mIHByb21pc2VzXG4gICAqIG9yIGFueSB2YWx1ZXMuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBOZXcgaW5zdGFuY2Ugb2YgUHJvbWlzZS5cbiAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9Qcm9taXNlL3JhY2VcbiAgICovXG4gIHN0YXRpYyByYWNlKGl0ZXJhYmxlKSB7XG4gICAgaWYgKGl0ZXJhYmxlW2l0ZXJhdG9yXSkge1xuICAgICAgaXRlcmFibGUgPSBpdGVyYWJsZVtpdGVyYXRvcl0oKTtcblxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgbGV0IG5leHQ7XG5cbiAgICAgICAgd2hpbGUgKCEobmV4dCA9IGl0ZXJhYmxlLm5leHQoKSkuZG9uZSkge1xuICAgICAgICAgIG5leHQudmFsdWUudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IGl0ZXJhYmxlLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGl0ZXJhYmxlW2ldLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIFByb21pc2UucmVqZWN0XG4gICAqIEBwYXJhbSB7Kn0gdmFsdWUgLSBWYWx1ZSB0byByZWplY3QuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBOZXcgaW5zdGFuY2Ugb2YgUHJvbWlzZS5cbiAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9Qcm9taXNlL3JlamVjdFxuICAgKi9cbiAgc3RhdGljIHJlamVjdCh2YWx1ZSkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZWplY3QodmFsdWUpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgUHJvbWlzZS5yZXNvbHZlXG4gICAqIEBwYXJhbSB7UHJvbWlzZXxUaGVuYWJsZXwqfSB2YWx1ZSAtIFByb21pc2UsIHRoZW5hYmxlIG9yIGFueSB2YWx1ZSB0byByZXNvbHZlLlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX0gTmV3IGluc3RhbmNlIG9mIFByb21pc2UuXG4gICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvUHJvbWlzZS9yZXNvbHZlXG4gICAqL1xuICBzdGF0aWMgcmVzb2x2ZSh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSAmJiBpc0Z1bmN0aW9uKHZhbHVlLnRoZW4pKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICByZXNvbHZlKHZhbHVlKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFib3J0KCkge31cblxuICAvKipcbiAgICogQG1ldGhvZCBQcm9taXNlI2NhdGNoXG4gICAqIEBwYXJhbSB7b25SZWplY3RlZH0gb25SZWplY3RlZCAtIG9uUmVqZWN0ZWQgY2FsbGJhY2suXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBOZXcgaW5zdGFuY2Ugb2YgUHJvbWlzZS5cbiAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9Qcm9taXNlL2NhdGNoXG4gICAqL1xuICBjYXRjaChvblJlamVjdGVkKSB7XG4gICAgcmV0dXJuIHRoaXMudGhlbihudWxsLCBvblJlamVjdGVkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIFByb21pc2UjZmluYWxseVxuICAgKiBAcHVibGljXG4gICAqIEBwYXJhbSB7b25GdWxmaWxsZWRPclJlamVjdGVkfSBvbkZ1bGZpbGxlZE9yUmVqZWN0ZWQgLSBvbkZ1bGZpbGxlZE9yUmVqZWN0ZWQgY2FsbGJhY2suXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxuICAgKiBAZGVzY3JpcHRpb24gTWV0aG9kIGZvciBjYXRjaGluZyBib3RoIGZ1bGZpbGxlZCBhbmQgcmVqZWN0ZWQgcHJvbWlzZXMuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHNwaW5uZXIuc2hvdygpO1xuICAgKiBmZXRjaERhdGEoKVxuICAgKiAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAqICAgICAvLyBkbyBzb21ldGhpbmcgd2l0aCBkYXRhXG4gICAqICAgfSlcbiAgICogICAuY2F0Y2goKGVycikgPT4ge1xuICAgKiAgICAgLy8gaGFuZGxlIGVycm9yIHNvbWVob3dcbiAgICogICB9KVxuICAgKiAgIC5maW5hbGx5KCgpID0+IHtcbiAgICogICAgIHNwaW5uZXIuaGlkZSgpO1xuICAgKiAgIH0pO1xuICAgKi9cbiAgZmluYWxseShvbkZ1bGZpbGxlZE9yUmVqZWN0ZWQpIHtcbiAgICBjb25zdCBpc0Z1bmMgPSBpc0Z1bmN0aW9uKG9uRnVsZmlsbGVkT3JSZWplY3RlZCk7XG5cbiAgICByZXR1cm4gdGhpcy50aGVuKCh2YWx1ZSkgPT4gKFxuICAgICAgUHJvbWlzZVxuICAgICAgICAucmVzb2x2ZShcbiAgICAgICAgICBpc0Z1bmNcbiAgICAgICAgICAgID8gb25GdWxmaWxsZWRPclJlamVjdGVkKHZhbHVlLCB0cnVlKVxuICAgICAgICAgICAgOiAwXG4gICAgICAgIClcbiAgICAgICAgLnRoZW4oKCkgPT4gdmFsdWUpXG4gICAgKSwgKGVycikgPT4gKFxuICAgICAgUHJvbWlzZVxuICAgICAgICAucmVzb2x2ZShcbiAgICAgICAgICBpc0Z1bmNcbiAgICAgICAgICAgID8gb25GdWxmaWxsZWRPclJlamVjdGVkKGVyciwgZmFsc2UpXG4gICAgICAgICAgICA6IDBcbiAgICAgICAgKVxuICAgICAgICAudGhlbigoKSA9PiBQcm9taXNlLnJlamVjdChlcnIpKVxuICAgICkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgUHJvbWlzZSN0aGVuXG4gICAqIEBwYXJhbSB7b25GdWxmaWxsZWR9IFtvbkZ1bGZpbGxlZF0gLSBvbkZ1bGZpbGxlZCBjYWxsYmFjay5cbiAgICogQHBhcmFtIHtvblJlamVjdGVkfSBbb25SZWplY3RlZF0gLSBvblJlamVjdGVkIGNhbGxiYWNrLlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX0gTmV3IGluc3RhbmNlIG9mIFByb21pc2UuXG4gICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvUHJvbWlzZS90aGVuXG4gICAqL1xuICB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7XG4gICAgY29uc3QgcHJvbWlzZSA9IHRoaXMuJCQ7XG5cbiAgICBpZiAocHJvbWlzZS5zdGF0dXMgPT09ICdwZW5kaW5nJykge1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgcHJvbWlzZS5oYW5kbGUoJ3JlamVjdCcsIG9uUmVqZWN0ZWQsIHJlc29sdmUsIHJlamVjdCwgc2VjcmV0KTtcbiAgICAgICAgcHJvbWlzZS5oYW5kbGUoJ3Jlc29sdmUnLCBvbkZ1bGZpbGxlZCwgcmVzb2x2ZSwgcmVqZWN0LCBzZWNyZXQpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJvbWlzZS5oYW5kbGVkID0gc2VjcmV0O1xuXG4gICAgY29uc3QgeyB2YWx1ZSB9ID0gcHJvbWlzZTtcblxuICAgIGxldCBtZXRob2Q7XG4gICAgbGV0IGhhbmRsZXI7XG5cbiAgICBpZiAocHJvbWlzZS5zdGF0dXMgPT09ICdmdWxmaWxsZWQnKSB7XG4gICAgICBtZXRob2QgPSAncmVzb2x2ZSc7XG4gICAgICBoYW5kbGVyID0gb25GdWxmaWxsZWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1ldGhvZCA9ICdyZWplY3QnO1xuICAgICAgaGFuZGxlciA9IG9uUmVqZWN0ZWQ7XG4gICAgfVxuXG4gICAgaWYgKCFpc0Z1bmN0aW9uKGhhbmRsZXIpKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZVttZXRob2RdKHZhbHVlKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShoYW5kbGVyKHZhbHVlKSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICB9XG4gIH1cbn1cblxuUHJvbWlzZS5vbkVycm9yID0gbnVsbDtcblByb21pc2Uub25VbmhhbmRsZWRSZWplY3Rpb24gPSBjb25zb2xlLmVycm9yLmJpbmQoY29uc29sZSwgJyVzICVvJywgJ1VuY2F1Z2h0IChpbiBwcm9taXNlKScpO1xuXG5leHBvcnQgZGVmYXVsdCBQcm9taXNlO1xuIiwiaW1wb3J0IHtcbiAgaXRlcmF0ZSxcbiAgdHJpbVxufSBmcm9tICcuL3V0aWxzJztcblxuZXhwb3J0IGRlZmF1bHQgKHJhd0hlYWRlcnMpID0+IHtcbiAgY29uc3QgaGVhZGVycyA9IHt9O1xuXG4gIGl0ZXJhdGUoKHJhd0hlYWRlcnMgfHwgJycpLnNwbGl0KCdcXG4nKSwgKHZhbHVlKSA9PiB7XG4gICAgY29uc3QgaW5kZXggPSB2YWx1ZS5pbmRleE9mKCc6Jyk7XG4gICAgY29uc3Qga2V5ID0gdHJpbSh2YWx1ZS5zdWJzdHJpbmcoMCwgaW5kZXgpKTtcbiAgICBjb25zdCB2YWwgPSB0cmltKHZhbHVlLnN1YnN0cmluZyhpbmRleCArIDEpKTtcblxuICAgIGlmIChrZXkpIHtcbiAgICAgIGhlYWRlcnNba2V5XSA9IChoZWFkZXJzW2tleV0gPyBgJHsgaGVhZGVyc1trZXldIH0sIGAgOiAnJykgKyB2YWw7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gaGVhZGVycztcbn07XG4iLCJpbXBvcnQge1xuICBpc09iamVjdCxcbiAgdG9TdHJpbmdUYWdcbn0gZnJvbSAnLi91dGlscyc7XG5cbmNvbnN0IG5vdFRvVHJhbnNmb3JtID0gWydGb3JtRGF0YScsICdGaWxlJywgJ0Jsb2InLCAnQXJyYXlCdWZmZXInLCAnU3RyaW5nJywgJ051bWJlciddO1xuY29uc3Qgd2l0aG91dEJvZHkgPSBbJ0RFTEVURScsICdHRVQnLCAnSEVBRCddO1xuXG5leHBvcnQgZGVmYXVsdCAoZGF0YSwgbWV0aG9kLCBoZWFkZXJzKSA9PiB7XG4gIGlmICh3aXRob3V0Qm9keS5pbmRleE9mKG1ldGhvZCkgIT09IC0xKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBpZiAoaXNPYmplY3QoZGF0YSkgJiYgbm90VG9UcmFuc2Zvcm0uaW5kZXhPZih0b1N0cmluZ1RhZyhkYXRhKSkgPT09IC0xKSB7XG4gICAgaWYgKCFoZWFkZXJzWydDb250ZW50LVR5cGUnXSkge1xuICAgICAgaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSAnYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04JztcbiAgICB9XG5cbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG4gIH1cblxuICByZXR1cm4gZGF0YTtcbn07XG4iLCJpbXBvcnQgQWpheGVyIGZyb20gJy4vbGliL0FqYXhlcic7XG5cbndpbmRvdy5BamF4ZXIgPSBBamF4ZXI7XG4iXSwibmFtZXMiOlsidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInRvU3RyaW5nIiwiY2FsbCIsInNsaWNlIiwiaXNGdW5jdGlvbiIsImlzT2JqZWN0IiwiaXNQcmltaXRpdmUiLCJ0ZXN0IiwiaXNTdHJpbmciLCJhc3NpZ24iLCJ0YXJnZXQiLCJvYmplY3RzIiwic291cmNlIiwia2V5IiwiaXRlcmF0ZSIsIm9iamVjdCIsImNhbGxiYWNrIiwiYXJyYXkiLCJpc0FycmF5IiwiaXRlcmF0ZWQiLCJsZW5ndGgiLCJoYXNPd25Qcm9wZXJ0eSIsIm1hcCIsIm5ld09iamVjdCIsInRyaW0iLCJzdHJpbmciLCJyZXBsYWNlIiwid2hpdGVTcGFjZSIsInJlcGxhY2VTdHJpbmciLCJzdHJpbmdUb1JlcGxhY2UiLCJyZXBsYWNlbWVudCIsInNwbGl0Iiwiam9pbiIsImRlZXBDbG9uZSIsImNsb25lIiwiZGVlcEFzc2lnbiIsImhhc093biIsInByb3BlcnR5IiwiaXNBYnNvbHV0ZSIsInVybCIsImFic29sdXRlVVJMUmVnZXhwIiwiZW5jb2RlIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwicXVlcnlTd2l0Y2hlciIsInF1ZXJ5IiwicHJlZml4IiwicXVlcnlQYXJhbXMiLCJwdXNoIiwicGFyYW0iLCJTdHJpbmciLCJlbXB0eUFycmF5IiwiZmV0Y2hCZWZvcmVNaWRkbGV3YXJlIiwiY29uZmlnIiwiYmFzZVVSTCIsImRhdGEiLCJoZWFkZXJzIiwibWV0aG9kIiwicGFyYW1zIiwiTUVUSE9EIiwidG9VcHBlckNhc2UiLCJjb25zdHJ1Y3RVUkwiLCJ0cmFuc2Zvcm1EYXRhIiwid2luZG93IiwiZ2xvYmFsIiwic2VsZiIsIkFycmF5Iiwic2VjcmV0IiwiaXRlcmF0b3IiLCJTeW1ib2wiLCJNYXRoIiwicmFuZG9tIiwiUHJvbWlzZSIsImV4ZWN1dG9yIiwicmVqZWN0IiwiZXJyIiwiaGlkZGVuUHJvbWlzZSIsInN0YXR1cyIsImkiLCJvblJlamVjdCIsImhhbmRsZWQiLCJvblVuaGFuZGxlZFJlamVjdGlvbiIsIm9uRXJyb3IiLCJyZXNvbHZlIiwidGhlbiIsIm9uRnVsZmlsbCIsIlR5cGVFcnJvciIsImhpZGRlblN0YXR1cyIsImhpZGRlblZhbHVlIiwicmVhbFByb21pc2UiLCJ0aGlzIiwidmFsIiwidW5kZWZpbmVkIiwiZGVmaW5lUHJvcGVydGllcyIsIiQkIiwiZiIsInByb3h5Iiwib25SZWplY3RlZCIsIm9uRnVsZmlsbGVkT3JSZWplY3RlZCIsImlzRnVuYyIsIm9uRnVsZmlsbGVkIiwicHJvbWlzZSIsImhhbmRsZSIsImhhbmRsZXIiLCJpdGVyYWJsZSIsInRvUmVzb2x2ZSIsIm5leHQiLCJkb25lIiwiY29uc29sZSIsImVycm9yIiwiYmluZCIsIlVSTCIsImluZGV4T2YiLCJwb3N0Zml4IiwicmF3SGVhZGVycyIsImluZGV4Iiwic3Vic3RyaW5nIiwibm90VG9UcmFuc2Zvcm0iLCJ3aXRob3V0Qm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkZWZhdWx0cyIsImxvY2F0aW9uIiwib3JpZ2luIiwidXBsb2FkTWV0aG9kcyIsIkFqYXhlciIsImFqYXhlciIsInJlcXVlc3QiLCJhcHBseSIsImFyZ3VtZW50cyIsImNvbmYiLCJiZWZvcmUiLCJkZWZpbmVQcm9wZXJ0eSIsInNldFByb3RvdHlwZU9mIiwicHJvdG90eXBlIiwibWlkZGxld2FyZSIsImFmdGVyQWxsIiwiYWZ0ZXIiLCJ1bnNoaWZ0IiwiYmVmb3JlQWxsIiwiaGVhZGVyIiwiZGF0YUNvbmZpZyIsInVybENvbmZpZyIsInhociIsImF1dGgiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwib25wcm9ncmVzcyIsInJlc3BvbnNlVHlwZSIsInRpbWVvdXQiLCJ3aXRoQ3JlZGVudGlhbHMiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJzZXRSZXF1ZXN0SGVhZGVyIiwidXBsb2FkIiwib25hYm9ydCIsIkVycm9yIiwidHlwZSIsIm9uZXJyb3IiLCJvbnRpbWVvdXQiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwicmVzcG9uc2UiLCJyZXNwb25zZVRleHQiLCJwYXJzZUhlYWRlcnMiLCJnZXRBbGxSZXNwb25zZUhlYWRlcnMiLCJzdGF0dXNUZXh0IiwiY2F0Y2giLCJlIiwic2VuZCIsImFib3J0IiwiRnVuY3Rpb24iXSwibWFwcGluZ3MiOiJ3QkFLQSxTQUVnQkEs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"}